var globalThis=this,global=this;function __skpm_run(e,t){globalThis.context=t;try{var r=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t){e.exports=require("sketch/dom")},function(e,t){function r(e,t,r,n){if(null==e)return log("parent is null for "+t),null;var o;o=null!=n?NSXMLElement.elementWithName_stringValue(NSString.stringWithFormat("%@",t),NSString.stringWithFormat("%@",n)):NSXMLElement.elementWithName(NSString.stringWithFormat("%@",t));for(var a=0;r&&a<r.length;a+=2)o.addAttribute(NSXMLNode.attributeWithName_stringValue(NSString.stringWithFormat("%@",r[a]),NSString.stringWithFormat("%@",r[a+1])));return e.addChild(o),o}e.exports={xmlAddElement:r,xmlAddAttributesToElement:function(e,t){if(null==e)return log("xmlAddAttributesToElement: element is null"),null;for(var r=0;t&&r<t.length;r+=2)e.addAttribute(NSXMLNode.attributeWithName_stringValue(NSString.stringWithFormat("%@",t[r]),NSString.stringWithFormat("%@",t[r+1])))},xmlAddCustomPropertiesToElement:function(e,t){for(;t.length>0;)r(e,"property",["key",t.shift().trim(),"value",t.shift().trim()],null)},exportXMLToPath:function(e,t){var r=NSXMLDocument.documentWithRootElement(t).XMLDataWithOptions(NSXMLNodePrettyPrint),n=NSString.stringWithFormat("%@",e).stringByExpandingTildeInPath();r.writeToFile(n)}}},function(e,t,r){var n={Sounds:{Basso:"Basso",Blow:"Blow",Bottle:"Bottle",Frog:"Frog",Funk:"Funk",Glass:"Glass",Hero:"Hero",Morse:"Morse",Ping:"Ping",Pop:"Pop",Purr:"Purr",Sosumi:"Sosumi",Submarine:"Submarine",Tink:"Tink"},playSoundNamed:function(e){var t=NSSound.soundNamed(e);t&&t.play()},chooseFolder:function(){var e=NSOpenPanel.openPanel();if(e.setCanChooseDirectories(!0),e.setCanChooseFiles(!1),e.setCanCreateDirectories(!0),e.runModal()==NSModalResponseOK){var t=e.URL().path();return 0==t.indexOf("file://")&&(t=t.substring(7)),t.endsWith("/")||(t+="/"),t}return null},showDialog:function(e){var t=NSApplication.sharedApplication();t&&t.displayDialog_withTitle(e,"Sketch2QML")},showInFinder:function(e){var t=MOPointer.alloc().init(),r=NSFileManager.defaultManager().attributesOfItemAtPath_error(e,t);r?r.isDirectory()?NSWorkspace.sharedWorkspace().openFile_withApplication(e,"Finder"):NSWorkspace.sharedWorkspace().selectFile_inFileViewerRootedAtPath(e,nil):console.warn("Utils.showInFinder: "+e+" does not exist or can't be read")},runCommand:function(e,t,r){var n=NSTask.alloc().init();return n.setLaunchPath_(e),r&&n.setCurrentDirectoryPath(r),n.arguments=t,n.launch(),n.waitUntilExit(),0==n.terminationStatus()},copyFile:function(e,t){var r=NSFileManager.defaultManager();r.fileExistsAtPath(e)?r.copyItemAtPath_toPath_error(e,t,null):console.warn("Utils.copyFile: file '"+e+"` does not exist")},fileExists:function(e){return NSFileManager.defaultManager().fileExistsAtPath(e)},expandTildeInPath:function(e){return String(NSString.stringWithString(e).stringByExpandingTildeInPath())},createDirectoryIfNeeded:function(e){var t=NSFileManager.defaultManager();return!!t.fileExistsAtPath(e)||(!!t.createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,!0,nil,nil)||(console.warn("Utils.createDirectoryIfNeeded: failed to create directory "+e),!1))},forceNewDirectory:function(e){var t=NSFileManager.defaultManager();return t.fileExistsAtPath(e)&&t.removeItemAtPath_error(e,nil),!!t.createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,!0,nil,nil)||(console.warn("Utils.forceNewDirectory: failed to create directory "+e),!1)},roundWithDecimalPrecision:function(e,t){var r=Math.pow(10,t||0);return Math.round(e*r)/r},roundBy:function(e,t){var r=1/(t||.5);return Math.round(e*r)/r},isLine:function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSShapePathLayer.class())&&"Custom"==e.shapeType&&2==e.points.length},exportLayerWithFormats:function(e,t,o,a,s,i){var l=0,u=0,d=0,c=0;if(!e||!t)return console.warn("Utils.exportLayerWithFormats: layer or exportPath is not defined"),[l,u,d,c];if(a.length>0){var h=r(0).getSelectedDocument(),p=e;o||(o=e.name),t.endsWith("/")||(t+="/");var m=!1,f=0!=e.transform.rotation,g=e.transform.flippedHorizontally,y=e.transform.flippedVertically,x=e.parent&&e.parent.sketchObject&&e.parent.sketchObject.isKindOfClass(MSLayerGroup.class());if(!i&&(1!=e.style.opacity||f||g||e.transform.flippedVertically||x)&&(m=!0,(p=e.duplicate()).parent=h.selectedPage,p.style.opacity=1,g&&(p.transform.flippedHorizontally=!1),y&&(p.transform.flippedVertically=!1),f))if(n.isLine(e)){var S=p.frame,b=p.points[0],E=b.point.x*S.width,v=b.point.y*S.height,F=p.points[1],A=F.point.x*S.width,k=F.point.y*S.height,D=180*Math.atan2(k-v,A-E)/Math.PI;p.transform.rotation=D}else p.transform.rotation=0;var T=p.sketchObject,M=T.absoluteRect().rect(),O=T.absoluteInfluenceRect(),C=M;if(!s&&!CGRectContainsRect(M,O)){C=O;var w=n.roundBy(M.origin.x,.5),L=n.roundBy(M.origin.y,.5),I=Math.ceil(M.size.width),N=Math.ceil(M.size.height);l=C.origin.y-L,u=L+N-(C.origin.y+C.size.height),d=C.origin.x-w,c=w+I-(C.origin.x+C.size.width)}r(0).version.sketch>=79?a.forEach((function(e){var r=e.sketchObject?e.sketchObject:e,n=MSExportRequest.exportRequestsFromExportableLayer_exportFormats_inRect_useIDForName(T,[r],C,!1).firstObject();n.setShouldTrim(!1),h.sketchObject.saveArtboardOrSlice_toFile(n,t+MSExportFormat.exportableFilenameForLayerName_exportFormat(o,r))})):a.forEach((function(e){var r=e.sketchObject?e.sketchObject:e,n=MSExportRequest.exportRequestFromExportFormat_layer_inRect_useIDForName(r,T,C,!1);n.setShouldTrim(!1),h.sketchObject.saveArtboardOrSlice_toFile(n,t+MSExportFormat.exportableFilenameForLayerName_exportFormat(o,r))})),m&&p.remove()}else console.warn("Utils.exportLayerWithFormats: no export format to export layer "+e.name);return[l,u,d,c]},exportLayerAsPNG:function(e,t,r,o,a,s){if(!e||!r)return console.warn("Utils.exportLayerAsPNG: layer or exportPath is not defined"),[0,0,0,0];t=Math.max(1,t);for(var i=[],l=1;l<=t;l++){var u=MSExportFormat.alloc().init();u.setFileFormat("png"),u.setScale(l),u.setName(1===l?"":"@"+l+"x"),i.push(u)}return n.exportLayerWithFormats(e,r,o,i,a,s)},exportLayerAsSVG:function(e,t,r,o,a){if(!e||!t)return console.warn("Utils.exportLayerAsSVG: layer or exportPath is not defined"),[0,0,0,0];var s=MSExportFormat.alloc().init();return s.setFileFormat("svg"),s.setScale(1),n.exportLayerWithFormats(e,t,r,[s],o,a)},exportLayerWithUserDefinedExportOptions:function(e,t,r,o,a){return e&&t?n.exportLayerWithFormats(e,t,r,e.exportFormats,o,a):(console.warn("Utils.exportLayerWithUserDefinedExportOptions: layer or exportPath is not defined"),[0,0,0,0])}};e.exports=n},function(e,t){e.exports=require("sketch/ui")},function(e,t,r){var n=["bool","true","false","double","float","real","int","long","short","string","url","var","let","function","if","else","for","while","do","break","switch","case","default","continue","root","delete","bottom","top","left","right","baseline"],o={A:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g,AE:/[\u00C6]/g,E:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g,I:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g,O:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g,OE:/[\u0152]/g,U:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g,a:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,ae:/[\u00E6\u01FD\u01E3]/g,c:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g,e:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,i:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,o:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,oe:/[\u0153]/g,u:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},a={};function s(e){return e[0]}function i(e){return e[1]}function l(e){return e[2]}function u(e){return e[4]}function d(){a={availableSwatchIDs:[],missingSwatches:{}}}function c(e,t){e&&e.fontFiles&&t&&!e.fontFiles.includes(t)&&e.fontFiles.push(t)}function h(e,t,n){var o=r(1);if(t){var a=w(t),s=t.style,i=n?n.style:null;if(s){var l=[];i&&s.opacity===i.opacity||(l.push("opacity"),l.push(s.opacity)),i&&s.blendingMode===i.blendingMode||(l.push("blendingMode"),l.push(s.blendingMode));var u="autoWidth";a&&(u=T(t),l.push("textBehaviour"),l.push(u)),i&&s.alignment==i.alignment||(l.push("alignment"),l.push(s.alignment));var d=a&&"fixedSize"!==u?"top":s.verticalAlignment;i&&d==i.verticalAlignment||(l.push("verticalAlignment"),l.push(d)),i&&s.textColor==i.textColor||(l.push("textColor"),l.push(function(e){return e.sketchObject&&e.sketchObject.textStyle()&&e.sketchObject.textStyle().attributes()&&e.sketchObject.textStyle().attributes().MSAttributedStringColorAttribute?F(e.sketchObject.textStyle().attributes().MSAttributedStringColorAttribute):k(e.textColor)}(s))),i&&s.lineHeight==i.lineHeight||s.lineHeight&&(l.push("lineHeight"),l.push(s.lineHeight)),i&&s.paragraphSpacing==i.paragraphSpacing||(l.push("paragraphSpacing"),l.push(s.paragraphSpacing));var c=!i||s.fontFamily!=i.fontFamily,h=!i||s.fontSize!=i.fontSize,p=!i||s.fontWeight!=i.fontWeight,m=!i||s.fontStyle!=i.fontStyle,f=!i||s.fontVariant!=i.fontVariant,g=!i||s.fontStretch!=i.fontStretch,y=!i||s.kerning!=i.kerning,x=!i||s.textTransform!=i.textTransform,S=!i||s.textUnderline!=i.textUnderline,b=!i||s.textStrikethrough!=i.textStrikethrough;(c||h||p||m||f||g||y||x||S||b)&&(l.push("fontFamily"),l.push(s.fontFamily),l.push("fontSize"),l.push(s.fontSize),l.push("fontWeight"),l.push(s.fontWeight),s.fontStyle&&(l.push("fontStyle"),l.push(s.fontStyle)),s.fontVariant&&(l.push("fontVariant"),l.push(s.fontVariant)),s.fontStretch&&(l.push("fontStretch"),l.push(s.fontStretch)),l.push("fontPostscriptName"),l.push(function(e){return e&&e.sketchObject?e.sketchObject.textStyle().fontPostscriptName():null}(s)),l.push("fontStyleName"),l.push(function(e){if(!e||!e.sketchObject)return null;var t=e.sketchObject.textStyle().attributes().NSFont.displayName().replace(e.fontFamily,"").trim();""===t&&(t="Regular");return t}(s)),s.kerning&&(l.push("kerning"),l.push(s.kerning)),l.push("textTransform"),l.push(s.textTransform),s.textUnderline&&(l.push("textUnderline"),l.push(s.textUnderline)),s.textStrikethrough&&(l.push("textStrikethrough"),l.push(s.textStrikethrough))),o.xmlAddAttributesToElement(e,l)}}}function p(e,t,n){if(n){var o=r(1),a=[];if(a.push("opacity"),a.push(n.opacity),a.push("blendingMode"),a.push(n.blendingMode),n.borderOptions){"None"!=n.borderOptions.startArrowhead&&(a.push("startArrowhead"),a.push(n.borderOptions.startArrowhead)),"None"!=n.borderOptions.endArrowhead&&(a.push("endArrowhead"),a.push(n.borderOptions.endArrowhead));var s=n.borderOptions.dashPattern.length;if(0!=s){a.push("dashPattern");var i=n.borderOptions.dashPattern.join(",");s%2==0?a.push(i):a.push(i+","+i)}"Butt"!=n.borderOptions.lineEnd&&(a.push("lineEnd"),a.push(n.borderOptions.lineEnd)),"Miter"!=n.borderOptions.lineJoin&&(a.push("lineJoin"),a.push(n.borderOptions.lineJoin))}n.fills.length>0&&n.fills.forEach((function(t){var r=o.xmlAddElement(e,"fill",null,null),n=[],a=t.fillType;if(n.push("fillType"),n.push(a),n.push("enabled"),n.push(t.enabled),"Color"==a)n.push("color"),n.push(E(t));else if("Gradient"==a){var s=t.gradient,i=s.gradientType;n.push("gradientType"),n.push(i),n.push("fromX"),n.push(s.from.x),n.push("fromY"),n.push(s.from.y),n.push("toX"),n.push(s.to.x),n.push("toY"),n.push(s.to.y),"Radial"==i&&(n.push("aspectRatio"),n.push(i.aspectRatio)),s.stops.forEach((function(e){var t=[];t.push("position"),t.push(e.position),t.push("color"),t.push(D(e.color)),o.xmlAddElement(r,"stop",t,null)}))}else"Pattern"==a&&(n.push("patternType"),n.push(t.pattern.patternType),n.push("tileScale"),n.push(t.pattern.tileScale));o.xmlAddAttributesToElement(r,n)})),n.borders.length>0&&n.borders.forEach((function(t){var r=o.xmlAddElement(e,"border",null,null),n=[],a=t.fillType;if(n.push("fillType"),n.push(a),n.push("thickness"),n.push(t.thickness),n.push("position"),n.push(t.position),n.push("enabled"),n.push(t.enabled),"Color"==a)n.push("color"),n.push(E(t));else if("Gradient"==a){var s=t.gradient,i=s.gradientType;n.push("gradientType"),n.push(i),n.push("fromX"),n.push(s.from.x),n.push("fromY"),n.push(s.from.y),n.push("toX"),n.push(s.to.x),n.push("toY"),n.push(s.to.y),"Radial"==i&&(n.push("aspectRatio"),n.push(i.aspectRatio)),s.stops.forEach((function(e){var t=[];t.push("position"),t.push(e.position),t.push("color"),t.push(D(e.color)),o.xmlAddElement(r,"stop",t,null)}))}o.xmlAddAttributesToElement(r,n)})),o.xmlAddAttributesToElement(e,a)}}function m(e,t,n,o,a,s,i,l,u){var d=r(1),c=r(2),m=[];m.push("id"),m.push(o.id),o.locked&&(m.push("locked"),m.push("1")),o.hidden&&(m.push("hidden"),m.push("1")),o.transform&&(0!==o.transform.rotation&&(m.push("rotation"),m.push(o.transform.rotation)),o.transform.flippedHorizontally&&(m.push("flippedHorizontally"),m.push("1")),o.transform.flippedVertically&&(m.push("flippedVertically"),m.push("1"))),o.sketchObject.hasFixedWidth()&&(m.push("hasFixedWidth"),m.push("1")),o.sketchObject.hasFixedHeight()&&(m.push("hasFixedHeight"),m.push("1")),o.sketchObject.hasFixedLeft()&&(m.push("hasFixedLeft"),m.push("1")),o.sketchObject.hasFixedTop()&&(m.push("hasFixedTop"),m.push("1")),o.sketchObject.hasFixedRight()&&(m.push("hasFixedRight"),m.push("1"),m.push("fixedRight"),m.push(o.parent?c.roundBy(o.parent.frame.width-(o.frame.x+o.frame.width),.5):0)),o.sketchObject.hasFixedBottom()&&(m.push("hasFixedBottom"),m.push("1"),m.push("fixedBottom"),m.push(o.parent?c.roundBy(o.parent.frame.height-(o.frame.y+o.frame.height),.5):0)),o.frame&&(m.push("x"),m.push(c.roundBy(o.frame.x,.5)),m.push("y"),m.push(c.roundBy(o.frame.y,.5)),m.push("width"),m.push(Math.ceil(o.frame.width)),m.push("height"),m.push(Math.ceil(o.frame.height))),o.flow&&o.flow.target&&d.xmlAddElement(t,"flow",["targetName",o.flow.target.name,"targetId",o.flow.targetId,"type",o.flow.animationType],null);var g=!1;if(i||function(e){return w(e)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSBitmapLayer.class())}(e)||(function(e){return e&&e.sketchObject.isKindOfClass(MSRectangleShape.class())&&e.sketchObject.isRectangle()}(e)||function(e){return e&&e.sketchObject.isKindOfClass(MSOvalShape.class())}(e)||L(e))&&function(e){var t=!0;if(e){if(t=!e.blur.enabled&&0==e.shadows.filter((function(e){return e.enabled})).length&&0==e.innerShadows.filter((function(e){return e.enabled})).length){var r=e.fills.filter((function(e){return e.enabled})),n=r.length;if(n>0){var o=r[n-1];t="Color"==o.fillType&&(1==n||"ff"===o.color.slice(-2))}}if(t){var a=e.borders.filter((function(e){return e.enabled})),s=a.length;if(s>0){var i=a[s-1];t="Color"==i.fillType&&1==s}}}return t}(e.style)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSLayerGroup.class())&&!e.sketchObject.isKindOfClass(MSShapeGroup.class())}(e)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSArtboardGroup.class())}(e)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSSymbolInstance.class())}(e)}(o)||(f(o,t,a,s,e,n),g=!0),"MSBitmapLayer"==n&&o.exportFormats&&0==o.exportFormats.length&&(f(o,t,a,s,e,n),g=!0),g)return d.xmlAddAttributesToElement(t,m),!0;var y=!1;if(o.exportFormats&&o.exportFormats.length>0&&C(n)&&(y=function(e,t,n,o,a){var s=!1;if(t.exportFormats.length>0){var i=r(1),l=r(2);o.endsWith("/")||(o+="/"),a.length>0&&!a.endsWith("/")&&(a+="/");var u=o+a;e=e+"__"+t.sketchObject.objectID();var d=l.exportLayerWithUserDefinedExportOptions(t,u,e,!1,!1);i.xmlAddAttributesToElement(n,["hasExport",t.exportFormats.length,"type","image","opacity",t.style.opacity,"topInset",d[0],"bottomInset",d[1],"leftInset",d[2],"rightInset",d[3]]),t.exportFormats.forEach((function(t){var r=t.sketchObject,o=MSExportFormat.exportableFilenameForLayerName_exportFormat(e,r),s=t.size,l=t.fileFormat,u=t.prefix?t.prefix:"",d=t.suffix?t.suffix:"",c=[];c.push("format"),c.push(l),c.push("size"),c.push(s),c.push("prefix"),c.push(u),c.push("suffix"),c.push(d),c.push("file"),c.push(a+o),i.xmlAddElement(n,"export",c,null)})),s=!0}return s}(e,o,t,a,s)),y)return d.xmlAddAttributesToElement(t,m),!0;if("MSArtboardGroup"==n||"MSLayerGroup"==n||"MSShapeGroup"==n||"MSOvalShape"==n||"MSRectangleShape"==n||"MSPolygonShape"==n||"MSStarShape"==n||"MSTriangleShape"==n||"MSShapePathLayer"==n||"MSBitmapLayer"==n||"MSTextLayer"==n||"MSSliceLayer"==n||i){var x=o.style;x&&("MSTextLayer"==n?o.sharedStyle?(m.push("useSharedStyle"),m.push(1),m.push("sharedStyleId"),m.push(o.sharedStyleId),o.sketchObject.isSharedStyleOutOfSync()?(m.push("isSharedStyleOutOfSync"),m.push(1),h(t,o,o.sharedStyle)):function(e,t){w(t)&&r(1).xmlAddAttributesToElement(e,["textBehaviour",T(t)])}(t,o)):h(t,o,null):(o.sharedStyle&&(m.push("useSharedStyle"),m.push(1)),p(t,0,x)))}if("MSShapePathLayer"==n||"MSOvalShape"==n||"MSRectangleShape"==n||"MSPolygonShape"==n||"MSStarShape"==n||"MSTriangleShape"==n||"MSShapeGroup"==n){m.push("shapeType"),m.push(o.shapeType),m.push("closed"),o.closed?m.push("1"):m.push("0");var S=o.points;S&&S.forEach((function(e){!function(e,t){if(t&&t.sketchObject){var n=r(1),o=t.pointType,a=[];if(a.push("pointType"),a.push(t.pointType),a.push("x"),a.push(t.point.x),a.push("y"),a.push(t.point.y),"Straight"==o)a.push("cornerRadius"),a.push(t.cornerRadius);else if("Undefined"==o){var s=t.sketchObject;s.hasCurveFrom()&&(a.push("curveFromX"),a.push(t.curveFrom.x),a.push("curveFromY"),a.push(t.curveFrom.y)),s.hasCurveTo()&&(a.push("curveToX"),a.push(t.curveTo.x),a.push("curveToY"),a.push(t.curveTo.y)),a.push("cornerRadius"),a.push(t.cornerRadius)}else"Undefined"!=o&&(a.push("curveFromX"),a.push(t.curveFrom.x),a.push("curveFromY"),a.push(t.curveFrom.y),a.push("curveToX"),a.push(t.curveTo.x),a.push("curveToY"),a.push(t.curveTo.y));n.xmlAddElement(e,"point",a,null)}else console.warn("treeAddAttributesFromPointData: invalid argument 'point'")}(t,e)}))}if("MSTextLayer"==n){var b=o.text;b&&d.xmlAddElement(t,"content",null,b.replace(/[\uE000-\uF8FF]/g,(function(e){return"\\u"+("000"+e.charCodeAt().toString(16)).slice(-4)})))}else"MSArtboardGroup"==n&&o.background&&o.background.enabled&&o.background.includedInExport&&(m.push("hasBackground"),m.push("1"),m.push("backgroundColor"),m.push(v(o)));return d.xmlAddAttributesToElement(t,m),!1}function f(e,t,n,o,a,s){var i=r(1),l=r(2);n.endsWith("/")||(n+="/"),o.length>0&&!o.endsWith("/")&&(o+="/");var u=n+o;a=a+"__"+e.sketchObject.objectID();for(var d=1,c=e.frame.width,h=e.frame.height,p=2;p<=2&&!(c*p>16384||h*p>16384);p++)d=p;var m=l.exportLayerAsPNG(e,d,u,a,!1,!1);i.xmlAddAttributesToElement(t,["hasExport",d,"type","image","opacity",e.style.opacity,"topInset",l.roundBy(m[0],.5),"bottomInset",l.roundBy(m[1],.5),"leftInset",l.roundBy(m[2],.5),"rightInset",l.roundBy(m[3],.5)]);for(var f=1;f<=d;f++){var g=[],y=a+(1!==f?"@"+f+"x":"")+".png";g.push("format"),g.push("png"),g.push("size"),g.push(f+"x"),g.push("prefix"),g.push(""),g.push("suffix"),g.push(1!==f?"@"+f+"x":""),g.push("file"),g.push(o+y),i.xmlAddElement(t,"export",g,null)}}function g(e,t,r,o,a){var s,i=e.sketchObject.class(),l=e.name.split("|"),u=l.shift().split("->"),d=""+i,c=!1,h=!1;"MSLayerGroup"==i||"MSShapeGroup"==i?d="group":"MSBitmapLayer"==i?d="image":"MSRectangleShape"==i?d="rectangle":"MSOvalShape"==i?d="oval":"MSShapePathLayer"==i?L(e)&&(d="line"):"MSTextLayer"==i?d="text":"MSArtboardGroup"==i?(d="window",h=!0):"MSSymbolMaster"==i&&(c=!0,h=!0);var p=null;if(1==u.length)s=u[0].trim();else{if(2!=u.length)return void log("treeAddLayerInGlobalNamesIndex: format error in layer's name - "+e.name);s=u[0].trim();var m=u[1].trim();h?p=m:d=m}(s=s.replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s{2,}/g," ").trim()).match(/^\d/)&&(s="n "+s),0==s.length?s="invalidName":n.includes(s.toLowerCase())&&(s="n "+s);var f=r[a[0]],g=s,y=0,x=S(g).toLowerCase();if(f.hasOwnProperty(x)){for(y=f[x]+1;f.hasOwnProperty(x+" i"+y);)y++;f[S(g=g+" i"+y).toLowerCase()]=1}else y=1;if(f[x]=y,c&&(d=g),d=d.trim(),g=b(g),l.length%2!=0&&(l.pop(),log("treeAddLayerInGlobalNamesIndex: odd number of key-values in layer's name - "+e.name)),t.globalNamesIndex[e.id]=[g,d,l,s,p],"MSTextLayer"==i&&e.sharedStyle&&e.sketchObject.isSharedStyleOutOfSync()&&(t.textsWithOutOfSyncStyle[e.id]=!0),"MSSymbolMaster"==i||"MSArtboardGroup"==i){var E=e.id;r[E]={},a.unshift(E),o.unshift("endOfContextScope")}if(!(e.exportFormats&&e.exportFormats.length>0&&C(i)||e.hidden||"MSArtboardGroup"!=i&&"MSLayerGroup"!=i&&"MSShapeGroup"!=i&&"MSSymbolMaster"!=i))for(var v=0;e.layers&&v<e.layers.length;v++)o.unshift(e.layers[v].id)}function y(e,t){for(var r=e.path.split("/"),n="",o=0;o<r.length;o++){var a=r[o];if(t[a])n=n+S(s(t[a]))+(o+1<r.length?".":"");else log("undefined index on overriden layer "+e.affectedLayer.name+" that may also be exportable")}return n}function x(e,t){var r=e.replace(/[^a-zA-Z0-9_]/g," ").replace(/\s{2,}/g," ").trim();r.match(/^\d/)&&(r="swatch "+r),0==r.length?r="swatch "+color.replace(/#/g,""):n.includes(r.toLowerCase())&&(r="swatch "+r);var o=r;if(t.has(o.toLowerCase())){var a=t.get(o.toLowerCase());for(o=r+" i"+ ++a;t.has(o.toLowerCase());)o=r+" i"+ ++a;t.set(r.toLowerCase(),a)}return o=b(o),t.set(o.toLowerCase(),0),o}function S(e){return function(e){return e.length>0&&/[^a-z_]/i.test(e.charAt(0))}(e=(e=(e=function(e){return Object.keys(o).reduce((function(e,t){var r=o[t];return e.replace(r,t)}),e)}(e)).replace(/[^a-zA-Z0-9\-_\s]/g,"")).trim())&&(e="n"+e),e.replace(/^([A-Z])|[\-_\s]+(\w)/g,(function(e,t,r,n){return r?r.toUpperCase():t.toLowerCase()}))}function b(e){return e?e[0].toLowerCase()+e.slice(1):""}function E(e){return e.sketchObject?F(e.sketchObject.color()):D(e.color)}function v(e){return e.sketchObject?F(e.sketchObject.backgroundColor()):D(e.background.color)}function F(e){var t=e.swatchID();if(t){var r=String(t);if(!a.availableSwatchIDs.includes(r)&&!a.missingSwatches.hasOwnProperty(r)){var n=A(e);log("Swatch with ID "+r+" not found (color: "+n+"). Please check that all named colors are imported"),a.missingSwatches[r]=n}return"swatch("+t+")"}return A(e)}function A(e){return D("#"+e.immutableModelObject().hexValue()+("0"+Math.round(255*e.alpha()).toString(16).toUpperCase()).slice(-2))}function k(e){return e.replace(/#(......)(..)/,"#$2$1")}function D(e){return"FF"===e.slice(-2).toUpperCase()?e.slice(0,-2):k(e)}function T(e){if(!w(e))return"";var t=e.sketchObject.textBehaviour();return 0==t?"autoWidth":1==t?"autoHeight":"fixedSize"}function M(e){return e&&w(e)?O(e.style):null}function O(e){var t=null;if(e&&e.sketchObject){var r=e.sketchObject.textStyle().attributes().NSFont;if(r){var n=r.fontDescriptor().objectForKey("NSCTFontFileURLAttribute");n&&(t=String(n.path()))}}return t}function C(e){return"MSArtboardGroup"!=e&&"MSSymbolMaster"!=e}function w(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSTextLayer.class())}function L(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSShapePathLayer.class())&&"Custom"==e.shapeType&&2==e.points.length}e.exports={addColorVariablesToXml:function(e){var t=r(0);if(t.version.sketch>=69){var n=r(1),o=new Map,s=t.getSelectedDocument(),i=[],l=s.sketchObject.documentData().allSwatches();for(var u in l.length>0&&l.forEach((function(e){var r=t.fromNative(e),n=D(r.color),a=x(r.name,o);i.push({id:r.sketchObject.objectID(),name:a,color:n})})),a.missingSwatches){var d=a.missingSwatches[u],c=x("missingSwatch "+d,o);log("Adding missing swatch "+u+" with name '"+c+"' (color: "+d+")"),i.push({id:u,name:c,color:d})}i.sort((function(e,t){return e.name!==t.name?e.name<t.name?-1:1:0})).forEach((function(t){n.xmlAddElement(e,"swatch",["id",t.id,"name",t.name,"color",t.color],null)}))}else console.warn("addColorVariablesToXml: can not export color variables - Sketch "+t.version.sketch+" is too old (required version is 69 or newer)")},addFontFilesToXml:function(e,t,n,o,a){if(e&&o&&o.length>0){var s=r(1),i=r(2);t.endsWith("/")||(t+="/"),n.length>0&&!n.endsWith("/")&&(n+="/");var l=t+n;i.createDirectoryIfNeeded(l);var u=[];o.sort().forEach((function(t){if(!a||!t.startsWith("/System/Library/Fonts")){var r=t.substring(t.lastIndexOf("/")+1);u.includes(r)||(u.push(r),s.xmlAddElement(e,"font",["name",r.replace(/\.[^/.]+$/,""),"file",n+r],null),i.copyFile(t,l+r))}}))}},addSharedTextStylesToXml:function(e){var t=r(1),o=r(0).getSelectedDocument(),a=new Map,s=[];o.sharedTextStyles.forEach((function(e){var t=e.name.replace(/[^a-zA-Z0-9_]/g," ").replace(/\s{2,}/g," ").trim();t.match(/^\d/)&&(t="textStyle "+t),0==t.length?t="textStyle":n.includes(t.toLowerCase())&&(t="textStyle "+t);var r=t;if(a.has(r.toLowerCase())){var o=a.get(r.toLowerCase());for(r=t+" i"+ ++o;a.has(r.toLowerCase());)r=t+" i"+ ++o;a.set(t.toLowerCase(),o)}r=b(r),a.set(r.toLowerCase(),0),s.push({id:e.id,name:r,sharedTextStyle:e})})),s.sort((function(e,t){return e.name!==t.name?e.name<t.name?-1:1:0})).forEach((function(r){h(t.xmlAddElement(e,"sharedtextstyle",["id",r.id,"name",r.name],null),r.sharedTextStyle,null)}))},clearTempContext:d,getBackgroundColorAsHexValueOrSwatchReference:v,getFontFilesUsedByLayer:function e(t,r){if(t){var n=M(t);n&&!r.includes(n)&&r.push(n),t.layers&&t.layers.length>0&&t.layers.forEach((function(t){e(t,r)}))}},getKeyValuesFromIndexedData:l,getParentTypeFromIndexedData:u,getTypeFromIndexedData:i,getUniqueNameFromIndexedData:s,initDocumentContext:function(){d();var e={fontFiles:[],sharedLayerStylesIndex:{},sharedTextStylesIndex:{},globalNamesIndex:{},textsWithOutOfSyncStyle:{}},t=r(0).getSelectedDocument();t.sharedLayerStyles.forEach((function(t){e.sharedLayerStylesIndex[t.id]=t})),t.sharedTextStyles.forEach((function(t){e.sharedTextStylesIndex[t.id]=t})),function(e){var t=r(0).getSelectedDocument(),n={},o=[];t.pages.forEach((function(e){e.name.startsWith("#")?e.layers.forEach((function(e){"MSSymbolMaster"==e.sketchObject.class()&&o.unshift(e.id)})):e.layers.forEach((function(e){var t=e.sketchObject.class();"MSSliceLayer"==t||"MSHotspotLayer"==t||e.name.startsWith("#")&&"MSSymbolMaster"!=t||o.unshift(e.id)}))}));var a=["DocumentRoot"];n.DocumentRoot={};for(;o.length>0;){var s=o.shift();if("endOfContextScope"!=s){var i=t.getLayerWithID(s);i&&g(i,e,n,o,a)}else{var l=a.shift();delete n[l]}}}(e);var n=Object.keys(e.globalNamesIndex).length;log("Indexed elements : "+n);var o=t.sketchObject.documentData().allSwatches();return o.length>0&&o.forEach((function(e){a.availableSwatchIDs.push(String(e.objectID()))})),e},pascalize:function(e){return function(e){return"string"!=typeof e?"":(std=e.trim(),0===e.length?"":e.charAt(0).toUpperCase()+e.slice(1))}(S(e))},treeIterateLayers:function e(t,n,o,a,d,h,f,g){for(var x=r(1),S=r(0).getSelectedDocument(),b=n,E=null,v=0;t&&v<t.length;v++){var F=t[v],A=F.sketchObject.class();if(!F.name.startsWith("#")&&(("MSSymbolMaster"!=A||!o)&&"MSArtboardGroup"!=A&&"MSSliceLayer"!=A&&"MSHotspotLayer"!=A)){var k=f.globalNamesIndex[F.id];if(k){var D=s(k),T=i(k),C=l(k),w=!1;if("includeLibrary"==T){var L=k[3],I=x.xmlAddElement(b,"include",["name",L],null);C.length>0&&addCustomPropertiesToXml(I,C)}else if("includeExternal"==T){var N=x.xmlAddElement(b,"external",["name",D],null);C.length>0&&addCustomPropertiesToXml(N,C)}else if("MSTextLayer"==A&&"includeData"==T){var P=x.xmlAddElement(b,"data",["name",D],F.text);C.length>0&&addCustomPropertiesToXml(P,C)}else{F._object.shouldBreakMaskChain()&&(b=n,E=null);var _=x.xmlAddElement(b,"item",["name",D],null);if(c(f,M(F)),"MSSymbolInstance"==A){if(!F.master){log("could not find the symbol master used by "+F.name),log("\t->Please check that it does not use an external symbol master that has not been made local.");continue}var B=f.globalNamesIndex[F.master.id];if(!B){log("could not find indexed data for "+F.master.name),log("\t->Please check that it is not an external symbol master that has not been made local.");continue}if(w=!0,A=T=i(B),F.overrides)for(var j=F.overrides.length,W={},X=0;X<j;X++){var R=F.overrides[X],G=R.editable,V=R.isDefault;if("image"==R.property||"textStyle"==R.property||"stringValue"==R.property||"layerStyle"==R.property||"symbolID"==R.property){var U=f.globalNamesIndex[R.affectedLayer.id],z=y(R,f.globalNamesIndex),H=z;if(!U){log("ERROR: could not find indexed data for "+R.affectedLayer.name+" ("+R.affectedLayer.id+"). Please check that this element is not rendered as an image.");continue}!R.sketchObject||R.sketchObject.overrideValue()&&R.sketchObject.defaultValue()!=R.sketchObject.currentValue()||(V=!0);for(var K=_,q=H,Y=H.lastIndexOf(".");Y>=0;){if((q=q.substring(0,Y)).length>0&W.hasOwnProperty(q)){K=W[q],H=H.substring(Y+1,H.length);break}Y=q.lastIndexOf(".")}if("image"==R.property){var Q=R.value.nsdata,Z=NSString.stringWithFormat("%@.png",R.id.replace(/\//g,"_")),J=NSString.stringWithFormat("%@%@",d,Z);Q.writeToFile_atomically(NSString.stringWithFormat("%@/%@",a,J),!1),x.xmlAddElement(K,"override",["property",R.property,"value",J,"on",H,"editable",G,"isDefault",V],null)}else if("textStyle"==R.property){var $=x.xmlAddElement(K,"override",["property",R.property,"value",R.value,"on",H,"editable",G,"isDefault",V],null);if(!f.sharedTextStylesIndex[R.value]){log("could not find textStyle"+R.value+" to override a symbol instance of "+F.name+". This override will be ignored"),log("\t->Please check that it is not an external text style that has not been made local.");continue}var ee=f.textsWithOutOfSyncStyle.hasOwnProperty(R.affectedLayer.id),te=f.sharedTextStylesIndex[R.value].style;ee?x.xmlAddElement($,"textStyle",["sharedStyleId",R.value,"affectedLayerStyleIsOutOfSync",!0],null):x.xmlAddElement($,"textStyle",["sharedStyleId",R.value],null),c(f,O(te))}else if("layerStyle"==R.property){var re=x.xmlAddElement(K,"override",["property",R.property,"value",R.value,"on",H,"editable",G,"isDefault",V],null);if(!f.sharedLayerStylesIndex[R.value]){log("could not find layerStyle"+R.value+" to override a symbol instance of "+F.name+". This override will be ignored"),log("\t->Please check that it is not an external layer style that has not been made local.");continue}p(x.xmlAddElement(re,"layerStyle",null,null),A,f.sharedLayerStylesIndex[R.value].style)}else if("stringValue"==R.property)x.xmlAddElement(K,"override",["property",R.property,"value",R.value,"on",H,"editable",G,"isDefault",V],null);else if("symbolID"==R.property){var ne=f.globalNamesIndex[R.affectedLayer.master.id];if(!ne){log("could not find indexed data for SymbolMaster "+R.affectedLayer.master.name+" to override a symbol instance of "+F.name+". This override will be ignored"),log("\t->Please check that it is not an external master that has not been made local.");continue}var oe=i(ne),ae="";if(R.value.length>0){var se=S.getSymbolMasterWithID(R.value);if(!se){log("could not find SymbolMaster with ID "+R.value+" to override a symbol instance of "+F.name+". This override will be ignored"),log("\t->Please check that it is not an external master that has not been made local.");break}var ie=f.globalNamesIndex[se.id];if(!ie){log("could not find indexed data for SymbolMaster "+se.name+" to override a symbol instance of "+F.name+". This override will be ignored"),log("\t->Please check that it is not an external master that has not been made local.");break}ae=i(ie)}var le=x.xmlAddElement(K,"override",["property",R.property,"newType",ae,"oldType",oe,"on",H,"editable",G,"isDefault",V],null);V||(W[z]=le)}}}x.xmlAddAttributesToElement(_,["symbolMaster",s(B),"type",T]);var ue=u(B);ue&&x.xmlAddAttributesToElement(_,["symbolMasterParentType",ue])}else x.xmlAddAttributesToElement(_,["type",T]);F._object.hasClippingMask()&&(x.xmlAddAttributesToElement(_,["isMask",1]),b=_,E=F),C.length>0&&addCustomPropertiesToXml(_,C),m(D,_,A,F,a,d,w,E,T)||!F||"MSArtboardGroup"!=A&&"MSLayerGroup"!=A&&"MSShapeGroup"!=A&&"MSSymbolMaster"!=A&&"MSSymbolInstance"!=A||e(F.layers,_,o,a,d,h,f,E)}}else log("ERROR: could not find indexed data for "+F.name+" ("+F.id+") : ignore this element.")}}},addSymbolMasterOverridesToXml:function(e,t,n){if(e.overrides){var o=r(1);e.overrides.forEach((function(e){if(e.editable&&("image"==e.property||"textStyle"==e.property||"stringValue"==e.property||"layerStyle"==e.property||"symbolID"==e.property)){var r=y(e,n.globalNamesIndex);o.xmlAddElement(t,"overridable",["property",e.property,"on",r],null)}}))}}}},function(e,t){e.exports=require("sketch/settings")},function(e,t,r){"use strict";function n(e){var t=e.plugin.urlForResourceNamed("icon.png").path(),r=NSImage.alloc().initByReferencingFile(t),n=NSAlert.alloc().init();n.setMessageText("Ingescape plugin"),n.setInformativeText("This plugin exports a Sketch file to an Ingescape Pivot format for code generation in Qt/QML, etc. to be used in Ingescape Circle"),n.icon=r,n.addButtonWithTitle("Get Circle"),n.addButtonWithTitle("Close"),n.runModal()==NSAlertFirstButtonReturn&&NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString("https://ingescape.com/circle/"))}function o(e){if(e.file){var t=r(0).Document,n=String(e.file),o=n.substring(n.lastIndexOf("/")+1,n.indexOf("."));o=(o=o.replace(/[^a-zA-Z0-9\-_\s]/g,"")).trim();var a=n.substring(0,n.lastIndexOf("/")+1)+o+"_export/";t.open(String(e.file),(function(t,o){t?console.warn("Can't open file ",n,!0):(i(e,a,!1),r(0).getSelectedDocument().close())}))}}function a(e){var t=r(4),n=r(1),o=r(2),a=r(0).getSelectedDocument(),s=r(5),i=r(3);if(a.path){var l=o.chooseFolder();if(l){var u=decodeURI(a.path).split("/"),d="Default";u.length>0&&(d=t.pascalize(u[u.length-1].replace(/.sketch/g,"")));var c=d,h="resources/"+c+"_library/fonts/",p="resources/"+c+"_library/images/";o.createDirectoryIfNeeded(l+h),o.forceNewDirectory(l+p),i.message("⚙️ Exporting library as Ingescape Pivot format. Please wait...");var m=t.initDocumentContext(),f=NSXMLElement.alloc().initWithName("library");n.xmlAddAttributesToElement(f,["name",c,"sketchVersion",s.version.sketch]);for(var g=a.getSymbols(),y=[],x=0;g&&x<g.length;x++){var S=g[x];if(!S.name.startsWith("#"))if(y.includes(S.id))log("WARNING: symbol already included (ID="+S.id+", name "+S.name+")");else{y.push(S.id);var b=m.globalNamesIndex[S.id];if(b){var E=t.getUniqueNameFromIndexedData(b),v=t.getTypeFromIndexedData(b),F=t.getKeyValuesFromIndexedData(b),A=t.getParentTypeFromIndexedData(b),k=n.xmlAddElement(f,"component",["type",v,"name",E,"width",S.frame.width,"height",S.frame.height,"hasBackground",S.background.enabled&&S.background.includedInInstance,"backgroundColor",t.getBackgroundColorAsHexValueOrSwatchReference(S)],null);A&&n.xmlAddAttributesToElement(k,["parentType",A]),F.length>0&&n.xmlAddCustomPropertiesToElement(k,F),t.addSymbolMasterOverridesToXml(S,k,m),t.treeIterateLayers(S.layers,k,!1,l,p,f,m,null)}else log("could not find indexed data for "+S.name+". This element will be ignored"),log("\t->Please check that it is not an external master that has not been made local.")}}t.addSharedTextStylesToXml(f),t.addFontFilesToXml(f,l,h,m.fontFiles,!1),t.addColorVariablesToXml(f),t.clearTempContext();var D=l+c+"_library.xml";n.exportXMLToPath(D,f),o.playSoundNamed(o.Sounds.Glass),i.message("✅ Library export completed to "+D),o.showInFinder(D)}else log("onExportLibraryAsXml: action cancelled by user")}else i.alert("Sketch2QML: can not export library as XML","You must save your Sketch file first")}function s(e){var t=r(4),n=r(1),o=r(2),a=r(0).getSelectedDocument(),s=r(5),i=r(3);if(a.path){var l=o.chooseFolder();if(l){var u=decodeURI(a.path).split("/"),d="Default";u.length>0&&(d=t.pascalize(u[u.length-1].replace(/.sketch/g,"")));var c=d,h="resources/"+c+"_app/fonts/",p="resources/"+c+"_app/images/";o.createDirectoryIfNeeded(l+h),o.forceNewDirectory(l+p),i.message("⚙️ Exporting application as Ingescape Pivot format. Please wait...");var m=t.initDocumentContext(),f=NSXMLElement.alloc().initWithName("app");n.xmlAddAttributesToElement(f,["name",c,"sketchVersion",s.version.sketch]);for(var g=0;g<a.pages.length;g++){var y=a.pages[g];if(!y.name.startsWith("#")){for(var x=n.xmlAddElement(f,"page",["name",y.name],null),S=[],b=[],E=0;E<y.layers.length;E++){var v=y.layers[E];"MSArtboardGroup"!=v.sketchObject.class()?b.push(v):S.push(v)}t.treeIterateLayers(b,x,!0,l,p,f,m,null);for(var F=0;F<S.length;F++){var A=S[F];if(!A.name.startsWith("#")){var k=m.globalNamesIndex[A.id];if(k){var D=t.getUniqueNameFromIndexedData(k),T=t.getTypeFromIndexedData(k),M=t.getKeyValuesFromIndexedData(k),O=t.getParentTypeFromIndexedData(k),C=n.xmlAddElement(x,"screen",["type",T,"name",D,"width",A.frame.width,"height",A.frame.height,"hasBackground",A.background.enabled&&A.background.includedInExport,"backgroundColor",t.getBackgroundColorAsHexValueOrSwatchReference(A)],null);O&&n.xmlAddAttributesToElement(C,["parentType",O]),M.length>0&&n.xmlAddCustomPropertiesToElement(C,M),t.treeIterateLayers(A.layers,C,!0,l,p,f,m,null)}else log("could not find indexed data for "+A.name+". This artboard will be ignored")}}}}t.addSharedTextStylesToXml(f),t.addFontFilesToXml(f,l,h,m.fontFiles,!1),t.addColorVariablesToXml(f),t.clearTempContext();var w=l+c+"_app.xml";n.exportXMLToPath(w,f),o.playSoundNamed(o.Sounds.Glass),i.message("✅ App export completed to "+w),o.showInFinder(w)}else log("onExportApplicationAsXml: action cancelled by user")}else i.alert("Sketch2QML: can not export application as XML","You must save your Sketch file first")}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=r(4),a=r(1),s=r(2),i=r(0),l=i.getSelectedDocument(),u=r(5),d=r(3),c=n&&""===t?s.chooseFolder():t;if(c){var h=decodeURI(l.path),p=h.split("/"),m="Default";p.length>0&&(m=o.pascalize(p[p.length-1].replace(/.sketch/g,"")));var f=m,g=m,y="resources/"+f+"_app/fonts/",x="resources/"+f+"_app/images/",S="resources/"+g+"_library/fonts/",b="resources/"+g+"_library/images/";s.createDirectoryIfNeeded(c+y),s.forceNewDirectory(c+x),s.createDirectoryIfNeeded(c+S),s.forceNewDirectory(c+b);var E=2;d.message("⚙️ [1/"+E+"] Exporting library as Ingescape Pivot format. Please wait...");var v=o.initDocumentContext(),F=NSXMLElement.alloc().initWithName("library");a.xmlAddAttributesToElement(F,["name",g,"sketchVersion",u.version.sketch]);for(var A=l.getSymbols(),k=[],D=0;A&&D<A.length;D++){var T=A[D];if(!T.name.startsWith("#"))if(k.includes(T.id))log("WARNING: symbol already included (ID="+T.id+", name "+T.name+")");else{k.push(T.id);var M=v.globalNamesIndex[T.id];if(M){var O=o.getUniqueNameFromIndexedData(M),C=o.getTypeFromIndexedData(M),w=o.getKeyValuesFromIndexedData(M),L=o.getParentTypeFromIndexedData(M),I=a.xmlAddElement(F,"component",["type",C,"name",O,"width",T.frame.width,"height",T.frame.height,"hasBackground",T.background.enabled&&T.background.includedInInstance,"backgroundColor",o.getBackgroundColorAsHexValueOrSwatchReference(T)],null);L&&a.xmlAddAttributesToElement(I,["parentType",L]),w.length>0&&a.xmlAddCustomPropertiesToElement(I,w),o.addSymbolMasterOverridesToXml(T,I,v),o.treeIterateLayers(T.layers,I,!1,c,b,F,v,null)}else log("could not find indexed data for "+T.name+". This element will be ignored"),log("\t->Please check that it is not an external master that has not been made local.")}}o.addSharedTextStylesToXml(F),o.addFontFilesToXml(F,c,S,v.fontFiles,!1),o.addColorVariablesToXml(F),a.exportXMLToPath(c+g+"_library.xml",F),d.message("⚙️ [2/"+E+"] Exporting application as Ingescape Pivot format. Please wait...");var N=NSXMLElement.alloc().initWithName("app");a.xmlAddAttributesToElement(N,["name",f,"sketchVersion",u.version.sketch]);for(var P=0;P<l.pages.length;P++){var _=l.pages[P];if(!_.name.startsWith("#")){for(var B=a.xmlAddElement(N,"page",["name",_.name],null),j=[],W=[],X=0;X<_.layers.length;X++){var R=_.layers[X],G=R.sketchObject.class();"MSArtboardGroup"!=G?W.push(R):j.push(R)}o.treeIterateLayers(W,B,!0,c,x,N,v,null);for(var V=0;V<j.length;V++){var U=j[V];if(!U.name.startsWith("#")){var z=v.globalNamesIndex[U.id];if(z){var H=o.getUniqueNameFromIndexedData(z),K=o.getTypeFromIndexedData(z),q=o.getKeyValuesFromIndexedData(z),Y=o.getParentTypeFromIndexedData(z),Q=a.xmlAddElement(B,"screen",["type",K,"name",H,"width",U.frame.width,"height",U.frame.height,"hasBackground",U.background.enabled&&U.background.includedInExport,"backgroundColor",o.getBackgroundColorAsHexValueOrSwatchReference(U)],null);Y&&a.xmlAddAttributesToElement(Q,["parentType",Y]),q.length>0&&a.xmlAddCustomPropertiesToElement(Q,q),o.treeIterateLayers(U.layers,Q,!0,c,x,N,v,null)}else log("could not find indexed data for "+U.name+". This artboard will be ignored")}}}}o.addSharedTextStylesToXml(N),o.addFontFilesToXml(N,c,y,v.fontFiles,!1),o.addColorVariablesToXml(N),o.clearTempContext(),a.exportXMLToPath(c+f+"_app.xml",N),n&&(s.playSoundNamed(s.Sounds.Glass),d.message("✅ Export of app and lib completed to "+c),s.showInFinder(c))}else log("exportWhole: action cancelled by user")}function l(e){i(e)}function u(e){var t=r(2),n=t.chooseFolder();if(n){var o=r(4),a=r(0).getSelectedDocument(),s=r(3),i=[];a.pages.forEach((function(e){o.getFontFilesUsedByLayer(e,i)})),i.length>0?(i.forEach((function(e){var r=e.substring(e.lastIndexOf("/")+1);t.copyFile(e,n+r)})),s.message("✅ Export completed - "+i.length+" font(s) exported to "+n),t.showInFinder(n)):s.alert("Sketch2QML: can not export fonts","❌ No font found in your Sketch document")}else log("onExportFonts: action cancelled by user")}function d(e){var t=r(2),n=r(0).getSelectedDocument(),o=r(3),a=n.selectedLayers;if(0==a.length)return o.alert("Sketch2QML: can not export PNG","❌ No layers are selected ‼️\n=> Please select one or multiple layers before exporting."),void NSBeep();var s=t.chooseFolder();s?(a.forEach((function(e){t.exportLayerAsPNG(e,4,s,e.name,!1,!1)})),o.message("✅ Export completed to "+s),t.showInFinder(s)):log("onExportSelectedLayersAsPNG: action cancelled by user")}function c(e){var t=r(2),n=r(0).getSelectedDocument(),o=r(3),a=n.selectedLayers;if(0==a.length)return o.alert("Sketch2QML: can not export SVG","❌ No layers are selected ‼️\n=> Please select one or multiple layers before exporting."),void NSBeep();var s=t.chooseFolder();s?(a.forEach((function(e){t.exportLayerAsSVG(e,s,e.name,!1,!1)})),o.message("✅ Export completed to "+s),t.showInFinder(s)):log("onExportSelectedLayersAsSVG: action cancelled by user")}function h(e){var t=r(2),n=r(0).getSelectedDocument(),o=r(3),a=n.selectedLayers;if(0==a.length)return o.alert("Sketch2QML: can not export images","❌ No layers are selected ‼️\n=> Please select one or multiple layers before exporting."),void NSBeep();var s=t.chooseFolder();s?(a.forEach((function(e){t.exportLayerWithUserDefinedExportOptions(e,s,e.name,!1,!1)})),o.message("✅ Export completed to "+s),t.showInFinder(s)):log("onExportSelectedLayersWithUserPredefinedExportOptions: action cancelled by user")}r.r(t),r.d(t,"onShowAboutDialog",(function(){return n})),r.d(t,"onOpenFileAndExportWholeAsXml",(function(){return o})),r.d(t,"onExportLibraryAsXml",(function(){return a})),r.d(t,"onExportApplicationAsXml",(function(){return s})),r.d(t,"onExportWholeAsXml",(function(){return l})),r.d(t,"onExportFonts",(function(){return u})),r.d(t,"onExportSelectedLayersAsPNG",(function(){return d})),r.d(t,"onExportSelectedLayersAsSVG",(function(){return c})),r.d(t,"onExportSelectedLayersWithUserPredefinedExportOptions",(function(){return h}))}]);if("default"===e&&"function"==typeof r)r(t);else{if("function"!=typeof r[e])throw new Error('Missing export named "'+e+'". Your command should contain something like `export function " + key +"() {}`.');r[e](t)}}catch(n){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw n;process.emit("uncaughtException",n,"uncaughtException")}}globalThis.onOpenFileAndExportWholeAsXml=__skpm_run.bind(this,"onOpenFileAndExportWholeAsXml"),globalThis.onRun=__skpm_run.bind(this,"default"),globalThis.onExportWholeAsXml=__skpm_run.bind(this,"onExportWholeAsXml"),globalThis.onExportLibraryAsXml=__skpm_run.bind(this,"onExportLibraryAsXml"),globalThis.onExportApplicationAsXml=__skpm_run.bind(this,"onExportApplicationAsXml"),globalThis.onShowAboutDialog=__skpm_run.bind(this,"onShowAboutDialog"),globalThis.onExportSelectedLayersAsPNG=__skpm_run.bind(this,"onExportSelectedLayersAsPNG"),globalThis.onExportSelectedLayersAsSVG=__skpm_run.bind(this,"onExportSelectedLayersAsSVG"),globalThis.onExportSelectedLayersWithUserPredefinedExportOptions=__skpm_run.bind(this,"onExportSelectedLayersWithUserPredefinedExportOptions"),globalThis.onExportFonts=__skpm_run.bind(this,"onExportFonts");