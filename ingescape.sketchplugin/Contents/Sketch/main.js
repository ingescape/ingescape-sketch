var globalThis=this,global=this;function __skpm_run(e,t){globalThis.context=t;try{var r=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t){e.exports=require("sketch/dom")},function(e,t){function r(e,t,r,n){if(null==e)return log("parent is null for "+t),null;var o;o=null!=n?NSXMLElement.elementWithName_stringValue(NSString.stringWithFormat("%@",t),NSString.stringWithFormat("%@",n)):NSXMLElement.elementWithName(NSString.stringWithFormat("%@",t));for(var a=0;r&&a<r.length;a+=2)o.addAttribute(NSXMLNode.attributeWithName_stringValue(NSString.stringWithFormat("%@",r[a]),NSString.stringWithFormat("%@",r[a+1])));return e.addChild(o),o}e.exports={xmlAddElement:r,xmlAddAttributesToElement:function(e,t){if(null==e)return log("xmlAddAttributesToElement: element is null"),null;for(var r=0;t&&r<t.length;r+=2)e.addAttribute(NSXMLNode.attributeWithName_stringValue(NSString.stringWithFormat("%@",t[r]),NSString.stringWithFormat("%@",t[r+1])))},xmlAddCustomPropertiesToElement:function(e,t){for(;t.length>0;)r(e,"property",["key",t.shift().trim(),"value",t.shift().trim()],null)},exportXMLToPath:function(e,t){var r=NSXMLDocument.documentWithRootElement(t).XMLDataWithOptions(NSXMLNodePrettyPrint),n=NSString.stringWithFormat("%@",e).stringByExpandingTildeInPath();r.writeToFile(n)}}},function(e,t,r){var n={Sounds:{Basso:"Basso",Blow:"Blow",Bottle:"Bottle",Frog:"Frog",Funk:"Funk",Glass:"Glass",Hero:"Hero",Morse:"Morse",Ping:"Ping",Pop:"Pop",Purr:"Purr",Sosumi:"Sosumi",Submarine:"Submarine",Tink:"Tink"},playSoundNamed:function(e){var t=NSSound.soundNamed(e);t&&t.play()},chooseFolder:function(){var e=NSOpenPanel.openPanel();if(e.setCanChooseDirectories(!0),e.setCanChooseFiles(!1),e.setCanCreateDirectories(!0),e.runModal()==NSModalResponseOK){var t=e.URL().path();return 0==t.indexOf("file://")&&(t=t.substring(7)),t.endsWith("/")||(t+="/"),t}return null},showDialog:function(e){var t=NSApplication.sharedApplication();t&&t.displayDialog_withTitle(e,"Sketch2QML")},showInFinder:function(e){var t=MOPointer.alloc().init(),r=NSFileManager.defaultManager().attributesOfItemAtPath_error(e,t);r?r.isDirectory()?NSWorkspace.sharedWorkspace().openFile_withApplication(e,"Finder"):NSWorkspace.sharedWorkspace().selectFile_inFileViewerRootedAtPath(e,nil):console.warn("Utils.showInFinder: "+e+" does not exist or can't be read")},runCommand:function(e,t,r){var n=NSTask.alloc().init();return n.setLaunchPath_(e),r&&n.setCurrentDirectoryPath(r),n.arguments=t,n.launch(),n.waitUntilExit(),0==n.terminationStatus()},copyFile:function(e,t){var r=NSFileManager.defaultManager();r.fileExistsAtPath(e)?r.copyItemAtPath_toPath_error(e,t,null):console.warn("Utils.copyFile: file '"+e+"` does not exist")},fileExists:function(e){return NSFileManager.defaultManager().fileExistsAtPath(e)},expandTildeInPath:function(e){return String(NSString.stringWithString(e).stringByExpandingTildeInPath())},createDirectoryIfNeeded:function(e){var t=NSFileManager.defaultManager();return!!t.fileExistsAtPath(e)||(!!t.createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,!0,nil,nil)||(console.warn("Utils.createDirectoryIfNeeded: failed to create directory "+e),!1))},forceNewDirectory:function(e){var t=NSFileManager.defaultManager();return t.fileExistsAtPath(e)&&t.removeItemAtPath_error(e,nil),!!t.createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,!0,nil,nil)||(console.warn("Utils.forceNewDirectory: failed to create directory "+e),!1)},roundWithDecimalPrecision:function(e,t){var r=Math.pow(10,t||0);return Math.round((e+Number.EPSILON)*r)/r},roundBy:function(e,t){var r=1/(t||.5);return Math.round(e*r)/r},isLine:function(e){return e&&e.sketchObject&&e.sketchObject.isLine()},MSLayerAbsoluteInfluenceRect:function(e){if(r(0).version.sketch>=96){var t=e.documentData(),n=e.immutableModelObject().influenceRectForBoundsInDocument(t);return e.convertRect_toLayer_(n,null)}return e.absoluteInfluenceRect()},exportLayerWithFormats:function(e,t,o,a,i,s){var l=0,u=0,c=0,d=0;if(!e||!t)return console.warn("Utils.exportLayerWithFormats: layer or exportPath is not defined"),[l,u,c,d];if(a.length>0){var h=r(0).getSelectedDocument(),p=e;o||(o=e.name),t.endsWith("/")||(t+="/");var m=0!=n.roundWithDecimalPrecision(-e.sketchObject.rotation(),3),f=e.transform.flippedHorizontally,g=e.transform.flippedVertically,y=e.parent&&e.parent.sketchObject&&e.parent.sketchObject.isKindOfClass(MSLayerGroup.class()),x=!1;if(!s&&(1!=e.style.opacity||m||f||g||y)&&(x=!0,(p=e.duplicate()).parent=h.selectedPage,p.style.opacity=1,f&&(p.transform.flippedHorizontally=!1),g&&(p.transform.flippedVertically=!1),m))if(n.isLine(e)){var b=p.frame,S=p.points[0],E=S.point.x*b.width,v=S.point.y*b.height,F=p.points[1],A=F.point.x*b.width,k=F.point.y*b.height,D=180*Math.atan2(k-v,A-E)/Math.PI;p.transform.rotation=D}else p.transform.rotation=0;var T=p.sketchObject,O=T.absoluteRect().rect(),M=n.MSLayerAbsoluteInfluenceRect(T),I=O;if(!i&&!CGRectContainsRect(O,M)){I=M;var C=n.roundBy(O.origin.x,.5),w=n.roundBy(O.origin.y,.5),L=Math.ceil(O.size.width),P=Math.ceil(O.size.height);l=I.origin.y-w,u=w+P-(I.origin.y+I.size.height),c=I.origin.x-C,d=C+L-(I.origin.x+I.size.width)}r(0).version.sketch>=79?a.forEach((function(e){var r=e.sketchObject?e.sketchObject:e,n=MSExportRequest.exportRequestsFromExportableLayer_exportFormats_inRect_useIDForName(T,[r],I,!1).firstObject();n.setShouldTrim(!1),h.sketchObject.saveArtboardOrSlice_toFile(n,t+MSExportFormat.exportableFilenameForLayerName_exportFormat(o,r))})):a.forEach((function(e){var r=e.sketchObject?e.sketchObject:e,n=MSExportRequest.exportRequestFromExportFormat_layer_inRect_useIDForName(r,T,I,!1);n.setShouldTrim(!1),h.sketchObject.saveArtboardOrSlice_toFile(n,t+MSExportFormat.exportableFilenameForLayerName_exportFormat(o,r))})),x&&p.remove()}else console.warn("Utils.exportLayerWithFormats: no export format to export layer "+e.name);return[l,u,c,d]},exportLayerAsPNG:function(e,t,r,o,a,i){if(!e||!r)return console.warn("Utils.exportLayerAsPNG: layer or exportPath is not defined"),[0,0,0,0];t=Math.max(1,t);for(var s=[],l=1;l<=t;l++){var u=MSExportFormat.alloc().init();u.setFileFormat("png"),u.setScale(l),u.setName(1===l?"":"@"+l+"x"),s.push(u)}return n.exportLayerWithFormats(e,r,o,s,a,i)},exportLayerAsSVG:function(e,t,r,o,a){if(!e||!t)return console.warn("Utils.exportLayerAsSVG: layer or exportPath is not defined"),[0,0,0,0];var i=MSExportFormat.alloc().init();return i.setFileFormat("svg"),i.setScale(1),n.exportLayerWithFormats(e,t,r,[i],o,a)},exportLayerWithUserDefinedExportOptions:function(e,t,r,o,a){return e&&t?n.exportLayerWithFormats(e,t,r,e.exportFormats,o,a):(console.warn("Utils.exportLayerWithUserDefinedExportOptions: layer or exportPath is not defined"),[0,0,0,0])}};e.exports=n},function(e,t){e.exports=require("sketch/ui")},function(e,t,r){var n=["bool","true","false","double","float","real","int","long","short","string","url","var","let","function","if","else","for","while","do","break","switch","case","default","continue","root","delete","bottom","top","left","right","baseline"],o={A:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g,AE:/[\u00C6]/g,E:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g,I:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g,O:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g,OE:/[\u0152]/g,U:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g,a:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,ae:/[\u00E6\u01FD\u01E3]/g,c:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g,e:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,i:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,o:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,oe:/[\u0153]/g,u:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},a={};function i(e){return e[0]}function s(e){return e[1]}function l(e){return e[2]}function u(e){return e[4]}function c(){a={availableSwatchIDs:[],missingSwatches:{},imageHashToFilePath:{}}}function d(e,t){e&&e.fontFiles&&t&&!e.fontFiles.includes(t)&&e.fontFiles.push(t)}function h(e,t,n){var o=r(1);if(t){var a=P(t),i=t.style,s=n?n.style:null;if(i){var l=[];s&&i.opacity===s.opacity||(l.push("opacity"),l.push(i.opacity)),s&&i.blendingMode===s.blendingMode||(l.push("blendingMode"),l.push(i.blendingMode));var u="autoWidth";a&&(u=M(t),l.push("textBehaviour"),l.push(u)),s&&i.alignment==s.alignment||(l.push("alignment"),l.push(i.alignment));var c=a&&"fixedSize"!==u?"top":i.verticalAlignment;s&&c==s.verticalAlignment||(l.push("verticalAlignment"),l.push(c)),s&&i.textColor==s.textColor||(l.push("textColor"),l.push(function(e){return e.sketchObject&&e.sketchObject.textStyle()&&e.sketchObject.textStyle().attributes()&&e.sketchObject.textStyle().attributes().MSAttributedStringColorAttribute?k(e.sketchObject.textStyle().attributes().MSAttributedStringColorAttribute):T(e.textColor)}(i))),s&&i.lineHeight==s.lineHeight||i.lineHeight&&(l.push("lineHeight"),l.push(i.lineHeight)),s&&i.paragraphSpacing==s.paragraphSpacing||(l.push("paragraphSpacing"),l.push(i.paragraphSpacing));var d=!s||i.fontFamily!=s.fontFamily,h=!s||i.fontSize!=s.fontSize,p=!s||i.fontWeight!=s.fontWeight,m=!s||i.fontStyle!=s.fontStyle,f=!s||i.fontVariant!=s.fontVariant,g=!s||i.fontStretch!=s.fontStretch,y=!s||i.kerning!=s.kerning,x=!s||i.textTransform!=s.textTransform,b=!s||i.textUnderline!=s.textUnderline,S=!s||i.textStrikethrough!=s.textStrikethrough;(d||h||p||m||f||g||y||x||b||S)&&(l.push("fontFamily"),l.push(i.fontFamily),l.push("fontSize"),l.push(i.fontSize),l.push("fontWeight"),l.push(i.fontWeight),i.fontStyle&&(l.push("fontStyle"),l.push(i.fontStyle)),i.fontVariant&&(l.push("fontVariant"),l.push(i.fontVariant)),i.fontStretch&&(l.push("fontStretch"),l.push(i.fontStretch)),l.push("fontPostscriptName"),l.push(function(e){return e&&e.sketchObject?e.sketchObject.textStyle().fontPostscriptName():null}(i)),l.push("fontStyleName"),l.push(function(e){if(!e||!e.sketchObject)return null;var t=e.sketchObject.textStyle().attributes().NSFont.displayName().replace(e.fontFamily,"").trim();""===t&&(t="Regular");return t}(i)),i.kerning&&(l.push("kerning"),l.push(i.kerning)),l.push("textTransform"),l.push(i.textTransform),i.textUnderline&&(l.push("textUnderline"),l.push(i.textUnderline)),i.textStrikethrough&&(l.push("textStrikethrough"),l.push(i.textStrikethrough))),o.xmlAddAttributesToElement(e,l)}}}function p(e,t,n){if(n){var o=r(1),a=[];if(a.push("opacity"),a.push(n.opacity),a.push("blendingMode"),a.push(n.blendingMode),n.borderOptions){"None"!=n.borderOptions.startArrowhead&&(a.push("startArrowhead"),a.push(n.borderOptions.startArrowhead)),"None"!=n.borderOptions.endArrowhead&&(a.push("endArrowhead"),a.push(n.borderOptions.endArrowhead));var i=n.borderOptions.dashPattern.length;if(0!=i){a.push("dashPattern");var s=n.borderOptions.dashPattern.join(",");i%2==0?a.push(s):a.push(s+","+s)}"Butt"!=n.borderOptions.lineEnd&&(a.push("lineEnd"),a.push(n.borderOptions.lineEnd)),"Miter"!=n.borderOptions.lineJoin&&(a.push("lineJoin"),a.push(n.borderOptions.lineJoin))}n.fills.length>0&&n.fills.forEach((function(t){var r=o.xmlAddElement(e,"fill",null,null),n=[],a=t.fillType;if(n.push("fillType"),n.push(a),n.push("enabled"),n.push(t.enabled),"Color"==a)n.push("color"),n.push(F(t));else if("Gradient"==a){var i=t.gradient,s=i.gradientType;n.push("gradientType"),n.push(s),n.push("fromX"),n.push(i.from.x),n.push("fromY"),n.push(i.from.y),n.push("toX"),n.push(i.to.x),n.push("toY"),n.push(i.to.y),"Radial"==s&&(n.push("aspectRatio"),n.push(s.aspectRatio)),i.stops.forEach((function(e){var t=[];t.push("position"),t.push(e.position),t.push("color"),t.push(O(e.color)),o.xmlAddElement(r,"stop",t,null)}))}else"Pattern"==a&&(n.push("patternType"),n.push(t.pattern.patternType),n.push("tileScale"),n.push(t.pattern.tileScale));o.xmlAddAttributesToElement(r,n)})),n.borders.length>0&&n.borders.forEach((function(t){var r=o.xmlAddElement(e,"border",null,null),n=[],a=t.fillType;if(n.push("fillType"),n.push(a),n.push("thickness"),n.push(t.thickness),n.push("position"),n.push(t.position),n.push("enabled"),n.push(t.enabled),"Color"==a)n.push("color"),n.push(F(t));else if("Gradient"==a){var i=t.gradient,s=i.gradientType;n.push("gradientType"),n.push(s),n.push("fromX"),n.push(i.from.x),n.push("fromY"),n.push(i.from.y),n.push("toX"),n.push(i.to.x),n.push("toY"),n.push(i.to.y),"Radial"==s&&(n.push("aspectRatio"),n.push(s.aspectRatio)),i.stops.forEach((function(e){var t=[];t.push("position"),t.push(e.position),t.push("color"),t.push(O(e.color)),o.xmlAddElement(r,"stop",t,null)}))}o.xmlAddAttributesToElement(r,n)})),o.xmlAddAttributesToElement(e,a)}}function m(e,t,n,o,i,s,l,u,c){var d=r(1),m=r(2),g=[];if(g.push("id"),g.push(o.id),o.locked&&(g.push("locked"),g.push("1")),o.hidden&&(g.push("hidden"),g.push("1")),o.transform){var y=m.roundWithDecimalPrecision(-o.sketchObject.rotation(),3);0!==y&&(g.push("rotation"),g.push(y)),o.transform.flippedHorizontally&&(g.push("flippedHorizontally"),g.push("1")),o.transform.flippedVertically&&(g.push("flippedVertically"),g.push("1"))}o.sketchObject.hasFixedWidth()&&(g.push("hasFixedWidth"),g.push("1")),o.sketchObject.hasFixedHeight()&&(g.push("hasFixedHeight"),g.push("1")),o.sketchObject.hasFixedLeft()&&(g.push("hasFixedLeft"),g.push("1")),o.sketchObject.hasFixedTop()&&(g.push("hasFixedTop"),g.push("1")),o.sketchObject.hasFixedRight()&&(g.push("hasFixedRight"),g.push("1"),g.push("fixedRight"),g.push(o.parent?m.roundBy(o.parent.frame.width-(o.frame.x+o.frame.width),.5):0)),o.sketchObject.hasFixedBottom()&&(g.push("hasFixedBottom"),g.push("1"),g.push("fixedBottom"),g.push(o.parent?m.roundBy(o.parent.frame.height-(o.frame.y+o.frame.height),.5):0)),o.frame&&(g.push("x"),g.push(m.roundBy(o.frame.x,.5)),g.push("y"),g.push(m.roundBy(o.frame.y,.5)),g.push("width"),g.push(Math.ceil(o.frame.width)),g.push("height"),g.push(Math.ceil(o.frame.height))),o.flow&&o.flow.target&&d.xmlAddElement(t,"flow",["targetName",o.flow.target.name,"targetId",o.flow.targetId,"type",o.flow.animationType],null);var x=!1;if(l||function(e){return P(e)||L(e)||(function(e){return e&&e.sketchObject.isKindOfClass(MSRectangleShape.class())&&e.sketchObject.isRectangle()}(e)||function(e){return e&&e.sketchObject.isKindOfClass(MSOvalShape.class())}(e)||function(e){return N(e)&&e.style&&e.style.borderOptions&&"None"==e.style.borderOptions.startArrowhead&&"None"==e.style.borderOptions.endArrowhead}(e))&&function(e){var t=!0;if(e){if(t=!e.blur.enabled&&0==e.shadows.filter((function(e){return e.enabled})).length&&0==e.innerShadows.filter((function(e){return e.enabled})).length){var r=e.fills.filter((function(e){return e.enabled})),n=r.length;if(n>0){var o=r[n-1];t="Color"==o.fillType&&(1==n||"ff"===o.color.slice(-2))}}if(t){var a=e.borders.filter((function(e){return e.enabled})),i=a.length;if(i>0){var s=a[i-1];t="Color"==s.fillType&&1==i}}}return t}(e.style)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSLayerGroup.class())&&!e.sketchObject.isKindOfClass(MSShapeGroup.class())}(e)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSArtboardGroup.class())}(e)||function(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSSymbolInstance.class())}(e)}(o)||(f(o,t,i,s,e,n),x=!0),"MSBitmapLayer"==n&&o.exportFormats&&0==o.exportFormats.length&&(!function(e,t,n,o,i,s){if(L(e)&&e.image&&function(e){var t=!0;e&&(t="Normal"==e.blendingMode&&0==e.fills.filter((function(e){return e.enabled})).length&&0==e.borders.filter((function(e){return e.enabled})).length&&0==e.shadows.filter((function(e){return e.enabled})).length&&0==e.innerShadows.filter((function(e){return e.enabled})).length&&!e.blur.enabled);return t}(e.style)){var l=r(1),u=e.image.sketchObject.hash(),c="";if(a.imageHashToFilePath.hasOwnProperty(u))c=a.imageHashToFilePath[u];else{n.endsWith("/")||(n+="/"),o.length>0&&!o.endsWith("/")&&(o+="/");var d=S(i)+"__"+e.sketchObject.objectID();c=o+d+".png",e.image.nsdata.writeToFile_atomically(NSString.stringWithFormat("%@%@",n,c),!1),a.imageHashToFilePath[u]=c}l.xmlAddAttributesToElement(t,["hasExport",1,"type","image","opacity",e.style.opacity,"topInset",0,"bottomInset",0,"leftInset",0,"rightInset",0]),l.xmlAddElement(t,"export",["format","png","size","1x","prefix","","suffix","","file",c],null)}else f(e,t,n,o,i,s)}(o,t,i,s,e,n),x=!0),x)return d.xmlAddAttributesToElement(t,g),!0;var b=!1;if(o.exportFormats&&o.exportFormats.length>0&&w(n)&&(b=function(e,t,n,o,a){var i=!1;if(t.exportFormats.length>0){var s=r(1),l=r(2);o.endsWith("/")||(o+="/"),a.length>0&&!a.endsWith("/")&&(a+="/");var u=o+a;e=S(e)+"__"+t.sketchObject.objectID();var c=l.exportLayerWithUserDefinedExportOptions(t,u,e,!1,!1);s.xmlAddAttributesToElement(n,["hasExport",t.exportFormats.length,"type","image","opacity",t.style.opacity,"topInset",c[0],"bottomInset",c[1],"leftInset",c[2],"rightInset",c[3]]),t.exportFormats.forEach((function(t){var r=t.sketchObject,o=MSExportFormat.exportableFilenameForLayerName_exportFormat(e,r),i=t.size,l=t.fileFormat,u=t.prefix?t.prefix:"",c=t.suffix?t.suffix:"",d=[];d.push("format"),d.push(l),d.push("size"),d.push(i),d.push("prefix"),d.push(u),d.push("suffix"),d.push(c),d.push("file"),d.push(a+o),s.xmlAddElement(n,"export",d,null)})),i=!0}return i}(e,o,t,i,s)),b)return d.xmlAddAttributesToElement(t,g),!0;if("MSArtboardGroup"==n||"MSLayerGroup"==n||"MSShapeGroup"==n||"MSOvalShape"==n||"MSRectangleShape"==n||"MSPolygonShape"==n||"MSStarShape"==n||"MSTriangleShape"==n||"MSShapePathLayer"==n||"MSBitmapLayer"==n||"MSTextLayer"==n||"MSSliceLayer"==n||l){var E=o.style;E&&("MSTextLayer"==n?o.sharedStyle?(g.push("useSharedStyle"),g.push(1),g.push("sharedStyleId"),g.push(o.sharedStyleId),o.sketchObject.isSharedStyleOutOfSync()?(g.push("isSharedStyleOutOfSync"),g.push(1),h(t,o,o.sharedStyle)):function(e,t){P(t)&&r(1).xmlAddAttributesToElement(e,["textBehaviour",M(t)])}(t,o)):h(t,o,null):(o.sharedStyle&&(g.push("useSharedStyle"),g.push(1)),p(t,0,E)))}if("MSShapePathLayer"==n||"MSOvalShape"==n||"MSRectangleShape"==n||"MSPolygonShape"==n||"MSStarShape"==n||"MSTriangleShape"==n||"MSShapeGroup"==n){g.push("shapeType"),g.push(o.shapeType),g.push("closed"),o.closed?g.push("1"):g.push("0");var F=o.points;F&&F.forEach((function(e){!function(e,t){if(t&&t.sketchObject){var n=r(1),o=r(2),a=t.pointType,i=[];if(i.push("pointType"),i.push(t.pointType),i.push("x"),i.push(o.roundWithDecimalPrecision(t.point.x,5)),i.push("y"),i.push(o.roundWithDecimalPrecision(t.point.y,5)),"Straight"==a)i.push("cornerRadius"),i.push(t.cornerRadius);else if("Undefined"==a){var s=t.sketchObject;s.hasCurveFrom()&&(i.push("curveFromX"),i.push(o.roundWithDecimalPrecision(t.curveFrom.x,5)),i.push("curveFromY"),i.push(o.roundWithDecimalPrecision(t.curveFrom.y,5))),s.hasCurveTo()&&(i.push("curveToX"),i.push(o.roundWithDecimalPrecision(t.curveTo.x,5)),i.push("curveToY"),i.push(o.roundWithDecimalPrecision(t.curveTo.y,5))),i.push("cornerRadius"),i.push(t.cornerRadius)}else"Undefined"!=a&&(i.push("curveFromX"),i.push(o.roundWithDecimalPrecision(t.curveFrom.x,5)),i.push("curveFromY"),i.push(o.roundWithDecimalPrecision(t.curveFrom.y,5)),i.push("curveToX"),i.push(o.roundWithDecimalPrecision(t.curveTo.x,5)),i.push("curveToY"),i.push(o.roundWithDecimalPrecision(t.curveTo.y,5)));n.xmlAddElement(e,"point",i,null)}else console.warn("treeAddAttributesFromPointData: invalid argument 'point'")}(t,e)}))}if("MSTextLayer"==n){var k=o.text;k&&d.xmlAddElement(t,"content",null,v(k))}else"MSArtboardGroup"==n&&o.background&&o.background.enabled&&o.background.includedInExport&&(g.push("hasBackground"),g.push("1"),g.push("backgroundColor"),g.push(A(o)));return d.xmlAddAttributesToElement(t,g),!1}function f(e,t,n,o,a,i){var s=r(1),l=r(2);n.endsWith("/")||(n+="/"),o.length>0&&!o.endsWith("/")&&(o+="/");var u=n+o;a=S(a)+"__"+e.sketchObject.objectID();for(var c=1,d=e.frame.width,h=e.frame.height,p=2;p<=2&&!(d*p>16384||h*p>16384);p++)c=p;var m=l.exportLayerAsPNG(e,c,u,a,!1,!1);s.xmlAddAttributesToElement(t,["hasExport",c,"type","image","opacity",e.style.opacity,"topInset",l.roundBy(m[0],.5),"bottomInset",l.roundBy(m[1],.5),"leftInset",l.roundBy(m[2],.5),"rightInset",l.roundBy(m[3],.5)]);for(var f=1;f<=c;f++){var g=[],y=a+(1!==f?"@"+f+"x":"")+".png";g.push("format"),g.push("png"),g.push("size"),g.push(f+"x"),g.push("prefix"),g.push(""),g.push("suffix"),g.push(1!==f?"@"+f+"x":""),g.push("file"),g.push(o+y),s.xmlAddElement(t,"export",g,null)}}function g(e,t,r,o,a){var i,s=e.sketchObject.class(),l=e.name.split("|"),u=l.shift().split("->"),c=""+s,d=!1,h=!1;"MSLayerGroup"==s||"MSShapeGroup"==s?c="group":"MSBitmapLayer"==s?c="image":"MSRectangleShape"==s?c="rectangle":"MSOvalShape"==s?c="oval":"MSShapePathLayer"==s?N(e)&&(c="line"):"MSTextLayer"==s?c="text":"MSArtboardGroup"==s?(c="window",h=!0):"MSSymbolMaster"==s&&(d=!0,h=!0);var p=null;if(1==u.length)i=u[0].trim();else{if(2!=u.length)return void log("treeAddLayerInGlobalNamesIndex: format error in layer's name - "+e.name);i=u[0].trim();var m=u[1].trim();h?p=m:c=m}(i=i.replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s{2,}/g," ").trim()).match(/^\d/)&&(i="n "+i),0==i.length?i="invalidName":n.includes(i.toLowerCase())&&(i="n "+i);var f=r[a[0]],g=i,y=0,x=S(g).toLowerCase();if(f.hasOwnProperty(x)){for(y=f[x]+1;f.hasOwnProperty(x+" i"+y);)y++;f[S(g=g+" i"+y).toLowerCase()]=1}else y=1;if(f[x]=y,d&&(c=g),c=c.trim(),g=E(g),l.length%2!=0&&(l.pop(),log("treeAddLayerInGlobalNamesIndex: odd number of key-values in layer's name - "+e.name)),t.globalNamesIndex[e.id]=[g,c,l,i,p],"MSTextLayer"==s&&e.sharedStyle&&e.sketchObject.isSharedStyleOutOfSync()&&(t.textsWithOutOfSyncStyle[e.id]=!0),"MSSymbolMaster"==s||"MSArtboardGroup"==s){var b=e.id;r[b]={},a.unshift(b),o.unshift("endOfContextScope")}if(!(e.exportFormats&&e.exportFormats.length>0&&w(s)||e.hidden||"MSArtboardGroup"!=s&&"MSLayerGroup"!=s&&"MSShapeGroup"!=s&&"MSSymbolMaster"!=s))for(var v=0;e.layers&&v<e.layers.length;v++)o.unshift(e.layers[v].id)}function y(e,t){for(var r=e.path.split("/"),n="",o=0;o<r.length;o++){var a=r[o];if(t[a])n=n+S(i(t[a]))+(o+1<r.length?".":"");else log("undefined index on overriden layer "+e.affectedLayer.name+" that may also be exportable")}return n}function x(e){return e.toLowerCase().replace(/\s+/g,"")}function b(e,t){var r=e.replace(/[^a-zA-Z0-9_]/g," ").replace(/\s{2,}/g," ").trim();r.match(/^\d/)&&(r="swatch "+r),0==r.length?r="swatch "+color.replace(/#/g,""):n.includes(r.toLowerCase())&&(r="swatch "+r);var o=x(r),a=r;if(t.has(o)){var i=t.get(o);for(a=r+" i"+ ++i;t.has(x(a));)a=r+" i"+ ++i;t.set(o,i)}return a=E(a),t.set(x(a),0),a}function S(e){return function(e){return e.length>0&&/[^a-z_]/i.test(e.charAt(0))}(e=(e=(e=function(e){return Object.keys(o).reduce((function(e,t){var r=o[t];return e.replace(r,t)}),e)}(e)).replace(/[^a-zA-Z0-9\-_\s]/g,"")).trim())&&(e="n"+e),e.replace(/^([A-Z])|[\-_\s]+(\w)/g,(function(e,t,r,n){return r?r.toUpperCase():t.toLowerCase()}))}function E(e){return e?e[0].toLowerCase()+e.slice(1):""}function v(e){var t=function(e){return e.replace(/[\u0000-\u0008\u000b\u000c\u000e-\u001f]/g,"")}(e);return(t=t.replace(/\\/g,"\\\\")).replace(/[\uE000-\uF8FF]/g,(function(e){return"\\u"+("000"+e.charCodeAt().toString(16)).slice(-4)}))}function F(e){return e.sketchObject?k(e.sketchObject.color()):O(e.color)}function A(e){return e.sketchObject?k(e.sketchObject.backgroundColor()):O(e.background.color)}function k(e){var t=e.swatchID();if(t){var r=String(t);if(!a.availableSwatchIDs.includes(r)&&!a.missingSwatches.hasOwnProperty(r)){var n=D(e);log("Swatch with ID "+r+" not found (color: "+n+"). Please check that all named colors are imported"),a.missingSwatches[r]=n}return"swatch("+t+")"}return D(e)}function D(e){return O("#"+e.immutableModelObject().hexValue()+("0"+Math.round(255*e.alpha()).toString(16).toUpperCase()).slice(-2))}function T(e){return e.replace(/#(......)(..)/,"#$2$1")}function O(e){return"FF"===e.slice(-2).toUpperCase()?e.slice(0,-2):T(e)}function M(e){if(!P(e))return"";var t=e.sketchObject.textBehaviour();return 0==t?"autoWidth":1==t?"autoHeight":"fixedSize"}function I(e){return e&&P(e)?C(e.style):null}function C(e){var t=null;if(e&&e.sketchObject){var r=e.sketchObject.textStyle().attributes().NSFont;if(r){var n=r.fontDescriptor().objectForKey("NSCTFontFileURLAttribute");n&&(t=String(n.path()))}}return t}function w(e){return"MSArtboardGroup"!=e&&"MSSymbolMaster"!=e}function L(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSBitmapLayer.class())}function P(e){return e&&e.sketchObject&&e.sketchObject.isKindOfClass(MSTextLayer.class())}function N(e){return e&&e.sketchObject&&e.sketchObject.isLine()}e.exports={addColorVariablesToXml:function(e){var t=r(0);if(t.version.sketch>=69){var n=r(1),o=new Map,i=t.getSelectedDocument(),s=[],l=i.sketchObject.documentData().allSwatches();for(var u in l.length>0&&l.forEach((function(e){var r=t.fromNative(e),n=O(r.color),a=b(r.name,o);s.push({id:r.sketchObject.objectID(),name:a,color:n})})),a.missingSwatches){var c=a.missingSwatches[u],d=b("missingSwatch "+c,o);log("Adding missing swatch "+u+" with name '"+d+"' (color: "+c+")"),s.push({id:u,name:d,color:c})}s.sort((function(e,t){return e.name!==t.name?e.name<t.name?-1:1:0})).forEach((function(t){n.xmlAddElement(e,"swatch",["id",t.id,"name",t.name,"color",t.color],null)}))}else console.warn("addColorVariablesToXml: can not export color variables - Sketch "+t.version.sketch+" is too old (required version is 69 or newer)")},addFontFilesToXml:function(e,t,n,o,a){if(e&&o&&o.length>0){var i=r(1),s=r(2);t.endsWith("/")||(t+="/"),n.length>0&&!n.endsWith("/")&&(n+="/");var l=t+n;s.createDirectoryIfNeeded(l);var u=[];o.sort().forEach((function(t){if(!a||!t.startsWith("/System/Library/Fonts")){var r=t.substring(t.lastIndexOf("/")+1);u.includes(r)||(u.push(r),i.xmlAddElement(e,"font",["name",r.replace(/\.[^/.]+$/,""),"file",n+r],null),s.copyFile(t,l+r))}}))}},addSharedTextStylesToXml:function(e){var t=r(1),o=r(0).getSelectedDocument(),a=new Map,i=[];o.sharedTextStyles.forEach((function(e){var t=e.name.replace(/[^a-zA-Z0-9_]/g," ").replace(/\s{2,}/g," ").trim();t.match(/^\d/)&&(t="textStyle "+t),0==t.length?t="textStyle":n.includes(t.toLowerCase())&&(t="textStyle "+t);var r=t;if(a.has(r.toLowerCase())){var o=a.get(r.toLowerCase());for(r=t+" i"+ ++o;a.has(r.toLowerCase());)r=t+" i"+ ++o;a.set(t.toLowerCase(),o)}r=E(r),a.set(r.toLowerCase(),0),i.push({id:e.id,name:r,sharedTextStyle:e})})),i.sort((function(e,t){return e.name!==t.name?e.name<t.name?-1:1:0})).forEach((function(r){h(t.xmlAddElement(e,"sharedtextstyle",["id",r.id,"name",r.name],null),r.sharedTextStyle,null)}))},clearTempContext:c,getBackgroundColorAsHexValueOrSwatchReference:A,getFontFilesUsedByLayer:function e(t,r){if(t){var n=I(t);n&&!r.includes(n)&&r.push(n),t.layers&&t.layers.length>0&&t.layers.forEach((function(t){e(t,r)}))}},getKeyValuesFromIndexedData:l,getParentTypeFromIndexedData:u,getTypeFromIndexedData:s,getUniqueNameFromIndexedData:i,initDocumentContext:function(e){c();var t={libraryImagesSubDir:e,fontFiles:[],sharedLayerStylesIndex:{},sharedTextStylesIndex:{},globalNamesIndex:{},textsWithOutOfSyncStyle:{}},n=r(0).getSelectedDocument();n.sharedLayerStyles.forEach((function(e){t.sharedLayerStylesIndex[e.id]=e})),n.sharedTextStyles.forEach((function(e){t.sharedTextStylesIndex[e.id]=e})),function(e){var t=r(0).getSelectedDocument(),n={},o=[];t.pages.forEach((function(e){e.name.startsWith("#")?e.layers.forEach((function(e){"MSSymbolMaster"==e.sketchObject.class()&&o.unshift(e.id)})):e.layers.forEach((function(e){var t=e.sketchObject.class();"MSSliceLayer"==t||"MSHotspotLayer"==t||e.name.startsWith("#")&&"MSSymbolMaster"!=t||o.unshift(e.id)}))}));var a=["DocumentRoot"];n.DocumentRoot={};for(;o.length>0;){var i=o.shift();if("endOfContextScope"!=i){var s=t.getLayerWithID(i);s&&g(s,e,n,o,a)}else{var l=a.shift();delete n[l]}}}(t);var o=Object.keys(t.globalNamesIndex).length;log("Indexed elements : "+o);var i=n.sketchObject.documentData().allSwatches();return i.length>0&&i.forEach((function(e){a.availableSwatchIDs.push(String(e.objectID()))})),t},pascalize:function(e){return function(e){return"string"!=typeof e?"":(std=e.trim(),0===e.length?"":e.charAt(0).toUpperCase()+e.slice(1))}(S(e))},treeIterateLayers:function e(t,n,o,c,h,f,g,x){for(var b=r(1),E=r(0).getSelectedDocument(),F=n,A=null,k=0;t&&k<t.length;k++){var D=t[k],T=D.sketchObject.class();if(!D.name.startsWith("#")&&(("MSSymbolMaster"!=T||!o)&&"MSArtboardGroup"!=T&&"MSSliceLayer"!=T&&"MSHotspotLayer"!=T)){var O=g.globalNamesIndex[D.id];if(O){var M=i(O),w=s(O),L=l(O),P=!1;if("includeLibrary"==w){var N=O[3],_=b.xmlAddElement(F,"include",["name",N],null);L.length>0&&b.xmlAddCustomPropertiesToElement(_,L)}else if("includeExternal"==w){var W=b.xmlAddElement(F,"external",["name",M],null);L.length>0&&b.xmlAddCustomPropertiesToElement(W,L)}else if("MSTextLayer"==T&&"includeData"==w){var j=b.xmlAddElement(F,"data",["name",M],D.text);L.length>0&&b.xmlAddCustomPropertiesToElement(j,L)}else{D._object.shouldBreakMaskChain()&&(F=n,A=null);var B=b.xmlAddElement(F,"item",["name",M],null);if(d(g,I(D)),"MSSymbolInstance"==T){if(!D.master){log("could not find the symbol master used by "+D.name),log("\t->Please check that it does not use an external symbol master that has not been made local.");continue}var R=g.globalNamesIndex[D.master.id];if(!R){log("could not find indexed data for "+D.master.name),log("\t->Please check that it is not an external symbol master that has not been made local.");continue}if(P=!0,T=w=s(R),D.overrides)for(var X=r(0).version.sketch,G=D.overrides.length,V={},U=0;U<G;U++){var z=D.overrides[U],H=z.editable,K=z.isDefault;if("image"==z.property||"textStyle"==z.property||"stringValue"==z.property||"layerStyle"==z.property||"symbolID"==z.property){var q=g.globalNamesIndex[z.affectedLayer.id],Y=y(z,g.globalNamesIndex),Q=Y;if(!q){log("ERROR: could not find indexed data for "+z.affectedLayer.name+" ("+z.affectedLayer.id+"). Please check that this element is not rendered as an image.");continue}X<96&&(!z.sketchObject||z.sketchObject.overrideValue()&&z.sketchObject.defaultValue()!=z.sketchObject.currentValue()||(K=!0));for(var Z=B,J=Q,$=Q.lastIndexOf(".");$>=0;){if((J=J.substring(0,$)).length>0&V.hasOwnProperty(J)){Z=V[J],Q=Q.substring($+1,Q.length);break}$=J.lastIndexOf(".")}if("image"==z.property){var ee=z.value.sketchObject.hash(),te="";if(a.imageHashToFilePath.hasOwnProperty(ee))te=a.imageHashToFilePath[ee];else if(K){var re=i(q);te=g.libraryImagesSubDir+S(re)+"__"+z.affectedLayer.id}else{te=h+(z.affectedLayer.id+"__"+ee)+".png",z.value.nsdata.writeToFile_atomically(NSString.stringWithFormat("%@/%@",c,te),!1),a.imageHashToFilePath[ee]=te}b.xmlAddElement(Z,"override",["property",z.property,"value",te,"on",Q,"editable",H,"isDefault",K],null)}else if("textStyle"==z.property){var ne=b.xmlAddElement(Z,"override",["property",z.property,"value",z.value,"on",Q,"editable",H,"isDefault",K],null);if(!g.sharedTextStylesIndex[z.value]){log("could not find textStyle"+z.value+" to override a symbol instance of "+D.name+". This override will be ignored"),log("\t->Please check that it is not an external text style that has not been made local.");continue}var oe=g.textsWithOutOfSyncStyle.hasOwnProperty(z.affectedLayer.id),ae=g.sharedTextStylesIndex[z.value].style;oe?b.xmlAddElement(ne,"textStyle",["sharedStyleId",z.value,"affectedLayerStyleIsOutOfSync",!0],null):b.xmlAddElement(ne,"textStyle",["sharedStyleId",z.value],null),d(g,C(ae))}else if("layerStyle"==z.property){var ie=b.xmlAddElement(Z,"override",["property",z.property,"value",z.value,"on",Q,"editable",H,"isDefault",K],null);if(!g.sharedLayerStylesIndex[z.value]){log("could not find layerStyle"+z.value+" to override a symbol instance of "+D.name+". This override will be ignored"),log("\t->Please check that it is not an external layer style that has not been made local.");continue}p(b.xmlAddElement(ie,"layerStyle",null,null),T,g.sharedLayerStylesIndex[z.value].style)}else if("stringValue"==z.property)b.xmlAddElement(Z,"override",["property",z.property,"value",v(z.value),"on",Q,"editable",H,"isDefault",K],null);else if("symbolID"==z.property){var se=g.globalNamesIndex[z.affectedLayer.master.id];if(!se){log("could not find indexed data for SymbolMaster "+z.affectedLayer.master.name+" to override a symbol instance of "+D.name+". This override will be ignored"),log("\t->Please check that it is not an external master that has not been made local.");continue}var le=s(se),ue="";if(z.value.length>0){var ce=E.getSymbolMasterWithID(z.value);if(!ce){log("could not find SymbolMaster with ID "+z.value+" to override a symbol instance of "+D.name+". This override will be ignored"),log("\t->Please check that it is not an external master that has not been made local.");break}var de=g.globalNamesIndex[ce.id];if(!de){log("could not find indexed data for SymbolMaster "+ce.name+" to override a symbol instance of "+D.name+". This override will be ignored"),log("\t->Please check that it is not an external master that has not been made local.");break}ue=s(de)}var he=b.xmlAddElement(Z,"override",["property",z.property,"newType",ue,"oldType",le,"on",Q,"editable",H,"isDefault",K],null);K||(V[Y]=he)}}}b.xmlAddAttributesToElement(B,["symbolMaster",i(R),"type",w]);var pe=u(R);pe&&b.xmlAddAttributesToElement(B,["symbolMasterParentType",pe])}else b.xmlAddAttributesToElement(B,["type",w]);D._object.hasClippingMask()&&(b.xmlAddAttributesToElement(B,["isMask",1]),F=B,A=D),L.length>0&&b.xmlAddCustomPropertiesToElement(B,L),m(M,B,T,D,c,h,P,A,w)||!D||"MSArtboardGroup"!=T&&"MSLayerGroup"!=T&&"MSShapeGroup"!=T&&"MSSymbolMaster"!=T&&"MSSymbolInstance"!=T||e(D.layers,B,o,c,h,f,g,A)}}else log("ERROR: could not find indexed data for "+D.name+" ("+D.id+") : ignore this element.")}}},addSymbolMasterOverridesToXml:function(e,t,n){if(e.overrides){var o=r(1);e.overrides.forEach((function(e){if(e.editable&&("image"==e.property||"textStyle"==e.property||"stringValue"==e.property||"layerStyle"==e.property||"symbolID"==e.property)){var r=y(e,n.globalNamesIndex);o.xmlAddElement(t,"overridable",["property",e.property,"on",r],null)}}))}}}},function(e,t){e.exports=require("sketch/settings")},function(e,t,r){"use strict";function n(e){var t=e.plugin.urlForResourceNamed("icon.png").path(),r=NSImage.alloc().initByReferencingFile(t),n=NSAlert.alloc().init();n.setMessageText("Ingescape plugin"),n.setInformativeText("This plugin exports a Sketch file to an Ingescape Pivot format for code generation in Qt/QML, etc. to be used in Ingescape Circle"),n.icon=r,n.addButtonWithTitle("Get Circle"),n.addButtonWithTitle("Close"),n.runModal()==NSAlertFirstButtonReturn&&NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString("https://ingescape.com/circle/"))}function o(e){if(e.file){var t=r(0).Document,n=String(e.file),o=n.substring(n.lastIndexOf("/")+1,n.indexOf("."));o=(o=o.replace(/[^a-zA-Z0-9\-_\s]/g,"")).trim();var a=n.substring(0,n.lastIndexOf("/")+1)+o+"_export/";t.open(String(e.file),(function(t,o){t?console.warn("Can't open file ",n,!0):(s(e,a,!1),r(0).getSelectedDocument().close())}))}}function a(e){var t=r(4),n=r(1),o=r(2),a=r(0).getSelectedDocument(),i=r(5),s=r(3);if(a.path){var l=o.chooseFolder();if(l){var u=decodeURI(a.path).split("/"),c="Default";u.length>0&&(c=t.pascalize(u[u.length-1].replace(/.sketch/g,"")));var d=c,h="resources/"+d+"_library/fonts/",p="resources/"+d+"_library/images/";o.createDirectoryIfNeeded(l+h),o.forceNewDirectory(l+p),s.message("⚙️ Exporting library as Ingescape Pivot format. Please wait...");var m=t.initDocumentContext(p),f=NSXMLElement.alloc().initWithName("library");n.xmlAddAttributesToElement(f,["name",d,"sketchVersion",i.version.sketch]);for(var g=a.getSymbols(),y=[],x=0;g&&x<g.length;x++){var b=g[x];if(!b.name.startsWith("#"))if(y.includes(b.id))log("WARNING: symbol already included (ID="+b.id+", name "+b.name+")");else{y.push(b.id);var S=m.globalNamesIndex[b.id];if(S){var E=t.getUniqueNameFromIndexedData(S),v=t.getTypeFromIndexedData(S),F=t.getKeyValuesFromIndexedData(S),A=t.getParentTypeFromIndexedData(S),k=n.xmlAddElement(f,"component",["type",v,"name",E,"width",b.frame.width,"height",b.frame.height,"hasBackground",b.background.enabled&&b.background.includedInInstance,"backgroundColor",t.getBackgroundColorAsHexValueOrSwatchReference(b)],null);A&&n.xmlAddAttributesToElement(k,["parentType",A]),F.length>0&&n.xmlAddCustomPropertiesToElement(k,F),t.addSymbolMasterOverridesToXml(b,k,m),t.treeIterateLayers(b.layers,k,!1,l,p,f,m,null)}else log("could not find indexed data for "+b.name+". This element will be ignored"),log("\t->Please check that it is not an external master that has not been made local.")}}t.addSharedTextStylesToXml(f),t.addFontFilesToXml(f,l,h,m.fontFiles,!1),t.addColorVariablesToXml(f),t.clearTempContext();var D=l+d+"_library.xml";n.exportXMLToPath(D,f),o.playSoundNamed(o.Sounds.Glass),s.message("✅ Library export completed to "+D),o.showInFinder(D)}else log("onExportLibraryAsXml: action cancelled by user")}else s.alert("Sketch2QML: can not export library as XML","You must save your Sketch file first")}function i(e){var t=r(4),n=r(1),o=r(2),a=r(0).getSelectedDocument(),i=r(5),s=r(3);if(a.path){var l=o.chooseFolder();if(l){var u=decodeURI(a.path).split("/"),c="Default";u.length>0&&(c=t.pascalize(u[u.length-1].replace(/.sketch/g,"")));var d=c,h="resources/"+d+"_app/fonts/",p="resources/"+d+"_app/images/",m="resources/"+libraryName+"_library/images/";o.createDirectoryIfNeeded(l+h),o.forceNewDirectory(l+p),s.message("⚙️ Exporting application as Ingescape Pivot format. Please wait...");var f=t.initDocumentContext(m),g=NSXMLElement.alloc().initWithName("app");n.xmlAddAttributesToElement(g,["name",d,"sketchVersion",i.version.sketch]);for(var y=0;y<a.pages.length;y++){var x=a.pages[y];if(!x.name.startsWith("#")){for(var b=n.xmlAddElement(g,"page",["name",x.name],null),S=[],E=[],v=0;v<x.layers.length;v++){var F=x.layers[v];"MSArtboardGroup"!=F.sketchObject.class()?E.push(F):S.push(F)}t.treeIterateLayers(E,b,!0,l,p,g,f,null);for(var A=0;A<S.length;A++){var k=S[A];if(!k.name.startsWith("#")){var D=f.globalNamesIndex[k.id];if(D){var T=t.getUniqueNameFromIndexedData(D),O=t.getTypeFromIndexedData(D),M=t.getKeyValuesFromIndexedData(D),I=t.getParentTypeFromIndexedData(D),C=n.xmlAddElement(b,"screen",["type",O,"name",T,"width",k.frame.width,"height",k.frame.height,"hasBackground",k.background.enabled&&k.background.includedInExport,"backgroundColor",t.getBackgroundColorAsHexValueOrSwatchReference(k)],null);I&&n.xmlAddAttributesToElement(C,["parentType",I]),M.length>0&&n.xmlAddCustomPropertiesToElement(C,M),t.treeIterateLayers(k.layers,C,!0,l,p,g,f,null)}else log("could not find indexed data for "+k.name+". This artboard will be ignored")}}}}t.addSharedTextStylesToXml(g),t.addFontFilesToXml(g,l,h,f.fontFiles,!1),t.addColorVariablesToXml(g),t.clearTempContext();var w=l+d+"_app.xml";n.exportXMLToPath(w,g),o.playSoundNamed(o.Sounds.Glass),s.message("✅ App export completed to "+w),o.showInFinder(w)}else log("onExportApplicationAsXml: action cancelled by user")}else s.alert("Sketch2QML: can not export application as XML","You must save your Sketch file first")}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=r(4),a=r(1),i=r(2),s=r(0),l=s.getSelectedDocument(),u=r(5),c=r(3),d=n&&""===t?i.chooseFolder():t;if(d){var h=decodeURI(l.path),p=h.split("/"),m="Default";p.length>0&&(m=o.pascalize(p[p.length-1].replace(/.sketch/g,"")));var f=m,g=m,y="resources/"+f+"_app/fonts/",x="resources/"+f+"_app/images/",b="resources/"+g+"_library/fonts/",S="resources/"+g+"_library/images/";i.createDirectoryIfNeeded(d+y),i.forceNewDirectory(d+x),i.createDirectoryIfNeeded(d+b),i.forceNewDirectory(d+S);var E=2;c.message("⚙️ [1/"+E+"] Exporting library as Ingescape Pivot format. Please wait...");var v=o.initDocumentContext(S),F=NSXMLElement.alloc().initWithName("library");a.xmlAddAttributesToElement(F,["name",g,"sketchVersion",u.version.sketch]);for(var A=l.getSymbols(),k=[],D=0;A&&D<A.length;D++){var T=A[D];if(!T.name.startsWith("#"))if(k.includes(T.id))log("WARNING: symbol already included (ID="+T.id+", name "+T.name+")");else{k.push(T.id);var O=v.globalNamesIndex[T.id];if(O){var M=o.getUniqueNameFromIndexedData(O),I=o.getTypeFromIndexedData(O),C=o.getKeyValuesFromIndexedData(O),w=o.getParentTypeFromIndexedData(O),L=a.xmlAddElement(F,"component",["type",I,"name",M,"width",T.frame.width,"height",T.frame.height,"hasBackground",T.background.enabled&&T.background.includedInInstance,"backgroundColor",o.getBackgroundColorAsHexValueOrSwatchReference(T)],null);w&&a.xmlAddAttributesToElement(L,["parentType",w]),C.length>0&&a.xmlAddCustomPropertiesToElement(L,C),o.addSymbolMasterOverridesToXml(T,L,v),o.treeIterateLayers(T.layers,L,!1,d,S,F,v,null)}else log("could not find indexed data for "+T.name+". This element will be ignored"),log("\t->Please check that it is not an external master that has not been made local.")}}o.addSharedTextStylesToXml(F),o.addFontFilesToXml(F,d,b,v.fontFiles,!1),o.addColorVariablesToXml(F),a.exportXMLToPath(d+g+"_library.xml",F),c.message("⚙️ [2/"+E+"] Exporting application as Ingescape Pivot format. Please wait...");var P=NSXMLElement.alloc().initWithName("app");a.xmlAddAttributesToElement(P,["name",f,"sketchVersion",u.version.sketch]);for(var N=0;N<l.pages.length;N++){var _=l.pages[N];if(!_.name.startsWith("#")){for(var W=a.xmlAddElement(P,"page",["name",_.name],null),j=[],B=[],R=0;R<_.layers.length;R++){var X=_.layers[R],G=X.sketchObject.class();"MSArtboardGroup"!=G?B.push(X):j.push(X)}o.treeIterateLayers(B,W,!0,d,x,P,v,null);for(var V=0;V<j.length;V++){var U=j[V];if(!U.name.startsWith("#")){var z=v.globalNamesIndex[U.id];if(z){var H=o.getUniqueNameFromIndexedData(z),K=o.getTypeFromIndexedData(z),q=o.getKeyValuesFromIndexedData(z),Y=o.getParentTypeFromIndexedData(z),Q=a.xmlAddElement(W,"screen",["type",K,"name",H,"width",U.frame.width,"height",U.frame.height,"hasBackground",U.background.enabled&&U.background.includedInExport,"backgroundColor",o.getBackgroundColorAsHexValueOrSwatchReference(U)],null);Y&&a.xmlAddAttributesToElement(Q,["parentType",Y]),q.length>0&&a.xmlAddCustomPropertiesToElement(Q,q),o.treeIterateLayers(U.layers,Q,!0,d,x,P,v,null)}else log("could not find indexed data for "+U.name+". This artboard will be ignored")}}}}o.addSharedTextStylesToXml(P),o.addFontFilesToXml(P,d,y,v.fontFiles,!1),o.addColorVariablesToXml(P),o.clearTempContext(),a.exportXMLToPath(d+f+"_app.xml",P),n&&(i.playSoundNamed(i.Sounds.Glass),c.message("✅ Export of app and lib completed to "+d),i.showInFinder(d))}else log("exportWhole: action cancelled by user")}function l(e){s(e)}function u(e){var t=r(2),n=t.chooseFolder();if(n){var o=r(4),a=r(0).getSelectedDocument(),i=r(3),s=[];a.pages.forEach((function(e){o.getFontFilesUsedByLayer(e,s)})),s.length>0?(s.forEach((function(e){var r=e.substring(e.lastIndexOf("/")+1);t.copyFile(e,n+r)})),i.message("✅ Export completed - "+s.length+" font(s) exported to "+n),t.showInFinder(n)):i.alert("Sketch2QML: can not export fonts","❌ No font found in your Sketch document")}else log("onExportFonts: action cancelled by user")}function c(e){var t=r(2),n=r(0).getSelectedDocument(),o=r(3),a=n.selectedLayers;if(0==a.length)return o.alert("Sketch2QML: can not export PNG","❌ No layers are selected ‼️\n=> Please select one or multiple layers before exporting."),void NSBeep();var i=t.chooseFolder();i?(a.forEach((function(e){t.exportLayerAsPNG(e,4,i,e.name,!1,!1)})),o.message("✅ Export completed to "+i),t.showInFinder(i)):log("onExportSelectedLayersAsPNG: action cancelled by user")}function d(e){var t=r(2),n=r(0).getSelectedDocument(),o=r(3),a=n.selectedLayers;if(0==a.length)return o.alert("Sketch2QML: can not export SVG","❌ No layers are selected ‼️\n=> Please select one or multiple layers before exporting."),void NSBeep();var i=t.chooseFolder();i?(a.forEach((function(e){t.exportLayerAsSVG(e,i,e.name,!1,!1)})),o.message("✅ Export completed to "+i),t.showInFinder(i)):log("onExportSelectedLayersAsSVG: action cancelled by user")}function h(e){var t=r(2),n=r(0).getSelectedDocument(),o=r(3),a=n.selectedLayers;if(0==a.length)return o.alert("Sketch2QML: can not export images","❌ No layers are selected ‼️\n=> Please select one or multiple layers before exporting."),void NSBeep();var i=t.chooseFolder();i?(a.forEach((function(e){t.exportLayerWithUserDefinedExportOptions(e,i,e.name,!1,!1)})),o.message("✅ Export completed to "+i),t.showInFinder(i)):log("onExportSelectedLayersWithUserPredefinedExportOptions: action cancelled by user")}r.r(t),r.d(t,"onShowAboutDialog",(function(){return n})),r.d(t,"onOpenFileAndExportWholeAsXml",(function(){return o})),r.d(t,"onExportLibraryAsXml",(function(){return a})),r.d(t,"onExportApplicationAsXml",(function(){return i})),r.d(t,"onExportWholeAsXml",(function(){return l})),r.d(t,"onExportFonts",(function(){return u})),r.d(t,"onExportSelectedLayersAsPNG",(function(){return c})),r.d(t,"onExportSelectedLayersAsSVG",(function(){return d})),r.d(t,"onExportSelectedLayersWithUserPredefinedExportOptions",(function(){return h}))}]);if("default"===e&&"function"==typeof r)r(t);else{if("function"!=typeof r[e])throw new Error('Missing export named "'+e+'". Your command should contain something like `export function " + key +"() {}`.');r[e](t)}}catch(n){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw n;process.emit("uncaughtException",n,"uncaughtException")}}globalThis.onOpenFileAndExportWholeAsXml=__skpm_run.bind(this,"onOpenFileAndExportWholeAsXml"),globalThis.onRun=__skpm_run.bind(this,"default"),globalThis.onExportWholeAsXml=__skpm_run.bind(this,"onExportWholeAsXml"),globalThis.onExportLibraryAsXml=__skpm_run.bind(this,"onExportLibraryAsXml"),globalThis.onExportApplicationAsXml=__skpm_run.bind(this,"onExportApplicationAsXml"),globalThis.onShowAboutDialog=__skpm_run.bind(this,"onShowAboutDialog"),globalThis.onExportSelectedLayersAsPNG=__skpm_run.bind(this,"onExportSelectedLayersAsPNG"),globalThis.onExportSelectedLayersAsSVG=__skpm_run.bind(this,"onExportSelectedLayersAsSVG"),globalThis.onExportSelectedLayersWithUserPredefinedExportOptions=__skpm_run.bind(this,"onExportSelectedLayersWithUserPredefinedExportOptions"),globalThis.onExportFonts=__skpm_run.bind(this,"onExportFonts");